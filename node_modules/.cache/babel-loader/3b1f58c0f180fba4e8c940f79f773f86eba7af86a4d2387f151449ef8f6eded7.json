{"ast":null,"code":"import _objectSpread from\"C:/Users/sungh/Desktop/chat_work_ver2/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{API_BASE_URL}from'../api/chatApi';/**\r\n * 공통 API 클라이언트 - fetch 패턴 통합\r\n */export async function apiRequest(endpoint){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const{method='GET',body,headers={},timeout=10000}=options;// 기본 헤더 설정\nconst defaultHeaders=_objectSpread({'Content-Type':'application/json'},headers);try{// 타임아웃 설정\nconst controller=new AbortController();const timeoutId=setTimeout(()=>controller.abort(),timeout);const response=await fetch(\"\".concat(API_BASE_URL).concat(endpoint),{method,headers:defaultHeaders,body:body?JSON.stringify(body):undefined,signal:controller.signal});clearTimeout(timeoutId);// 응답 처리\nif(response.ok){const data=await response.json();return{data};}else{const errorData=await response.json().catch(()=>null);const errorMessage=(errorData===null||errorData===void 0?void 0:errorData.detail)||\"\\uC11C\\uBC84 \\uC624\\uB958 (\".concat(response.status,\")\");return{error:errorMessage};}}catch(error){var _error$message;if(error.name==='AbortError'){return{error:'요청 시간 초과: 서버 응답이 너무 늦습니다.'};}else if((_error$message=error.message)!==null&&_error$message!==void 0&&_error$message.includes('fetch')){return{error:'백엔드 서버에 연결할 수 없습니다. 서버가 실행 중인지 확인해주세요.'};}else{return{error:\"\\uB124\\uD2B8\\uC6CC\\uD06C \\uC624\\uB958: \".concat(error.message||error)};}}}/**\r\n * 공통 GET 요청\r\n */export async function apiGet(endpoint){return apiRequest(endpoint,{method:'GET'});}/**\r\n * 공통 POST 요청\r\n */export async function apiPost(endpoint,body){return apiRequest(endpoint,{method:'POST',body});}/**\r\n * 공통 PUT 요청\r\n */export async function apiPut(endpoint,body){return apiRequest(endpoint,{method:'PUT',body});}/**\r\n * 공통 DELETE 요청\r\n */export async function apiDelete(endpoint){return apiRequest(endpoint,{method:'DELETE'});}/**\r\n * 에러 처리 유틸리티\r\n */export function handleApiError(error){var _error$response,_error$response$data;let defaultMessage=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'작업에 실패했습니다';if(error!==null&&error!==void 0&&(_error$response=error.response)!==null&&_error$response!==void 0&&(_error$response$data=_error$response.data)!==null&&_error$response$data!==void 0&&_error$response$data.detail){return error.response.data.detail;}if(error!==null&&error!==void 0&&error.message){return error.message;}return defaultMessage;}/**\r\n * 저장고 관리를 위한 제네릭 클래스\r\n */export class VaultManager{constructor(baseEndpoint){this.baseEndpoint=baseEndpoint;}async getAll(){return apiGet(this.baseEndpoint);}async create(request){return apiPost(this.baseEndpoint,request);}async delete(id){return apiDelete(\"\".concat(this.baseEndpoint,\"/\").concat(id));}async update(id,request){return apiPut(\"\".concat(this.baseEndpoint,\"/\").concat(id),request);}async interact(id){let request=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return apiPost(\"\".concat(this.baseEndpoint,\"/\").concat(id,\"/interact\"),request);}}/**\r\n * 통합 채팅 함수\r\n */export async function universalChat(request){const{personaId,message,contextType,contextContent,threadId,conversationId}=request;// 채팅 타입에 따른 엔드포인트 결정\nif(contextType==='verbalization'){return apiPost('/verbalization/chat',{user_message:message,thread_id:threadId});}else if(threadId){return apiPost('/threads/chat',{thread_id:threadId,user_message:message});}else if(contextType&&contextContent){return apiPost('/chat/with-context',{persona_id:personaId,user_message:message,context_type:contextType,context_content:contextContent,thread_id:threadId});}else if(conversationId){return apiPost('/chat/continue',{persona_id:personaId,user_message:message,conversation_id:conversationId});}else{return apiPost('/chat/initial',{content:message});}}","map":{"version":3,"names":["API_BASE_URL","apiRequest","endpoint","options","arguments","length","undefined","method","body","headers","timeout","defaultHeaders","_objectSpread","controller","AbortController","timeoutId","setTimeout","abort","response","fetch","concat","JSON","stringify","signal","clearTimeout","ok","data","json","errorData","catch","errorMessage","detail","status","error","_error$message","name","message","includes","apiGet","apiPost","apiPut","apiDelete","handleApiError","_error$response","_error$response$data","defaultMessage","VaultManager","constructor","baseEndpoint","getAll","create","request","delete","id","update","interact","universalChat","personaId","contextType","contextContent","threadId","conversationId","user_message","thread_id","persona_id","context_type","context_content","conversation_id","content"],"sources":["C:/Users/sungh/Desktop/chat_work_ver2/frontend/src/features/shared/utils/apiUtils.ts"],"sourcesContent":["import { API_BASE_URL } from '../api/chatApi';\r\n\r\nexport interface ApiRequestOptions {\r\n  method?: 'GET' | 'POST' | 'PUT' | 'DELETE';\r\n  body?: any;\r\n  headers?: Record<string, string>;\r\n  timeout?: number;\r\n}\r\n\r\nexport interface ApiResponse<T> {\r\n  data?: T;\r\n  error?: string;\r\n}\r\n\r\n/**\r\n * 공통 API 클라이언트 - fetch 패턴 통합\r\n */\r\nexport async function apiRequest<T>(\r\n  endpoint: string, \r\n  options: ApiRequestOptions = {}\r\n): Promise<ApiResponse<T>> {\r\n  const {\r\n    method = 'GET',\r\n    body,\r\n    headers = {},\r\n    timeout = 10000\r\n  } = options;\r\n\r\n  // 기본 헤더 설정\r\n  const defaultHeaders: Record<string, string> = {\r\n    'Content-Type': 'application/json',\r\n    ...headers\r\n  };\r\n\r\n  try {\r\n    // 타임아웃 설정\r\n    const controller = new AbortController();\r\n    const timeoutId = setTimeout(() => controller.abort(), timeout);\r\n\r\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\r\n      method,\r\n      headers: defaultHeaders,\r\n      body: body ? JSON.stringify(body) : undefined,\r\n      signal: controller.signal,\r\n    });\r\n\r\n    clearTimeout(timeoutId);\r\n\r\n    // 응답 처리\r\n    if (response.ok) {\r\n      const data = await response.json();\r\n      return { data };\r\n    } else {\r\n      const errorData = await response.json().catch(() => null);\r\n      const errorMessage = errorData?.detail || `서버 오류 (${response.status})`;\r\n      return { error: errorMessage };\r\n    }\r\n\r\n  } catch (error: any) {\r\n    if (error.name === 'AbortError') {\r\n      return { error: '요청 시간 초과: 서버 응답이 너무 늦습니다.' };\r\n    } else if (error.message?.includes('fetch')) {\r\n      return { error: '백엔드 서버에 연결할 수 없습니다. 서버가 실행 중인지 확인해주세요.' };\r\n    } else {\r\n      return { error: `네트워크 오류: ${error.message || error}` };\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * 공통 GET 요청\r\n */\r\nexport async function apiGet<T>(endpoint: string): Promise<ApiResponse<T>> {\r\n  return apiRequest<T>(endpoint, { method: 'GET' });\r\n}\r\n\r\n/**\r\n * 공통 POST 요청\r\n */\r\nexport async function apiPost<T>(endpoint: string, body?: any): Promise<ApiResponse<T>> {\r\n  return apiRequest<T>(endpoint, { method: 'POST', body });\r\n}\r\n\r\n/**\r\n * 공통 PUT 요청\r\n */\r\nexport async function apiPut<T>(endpoint: string, body?: any): Promise<ApiResponse<T>> {\r\n  return apiRequest<T>(endpoint, { method: 'PUT', body });\r\n}\r\n\r\n/**\r\n * 공통 DELETE 요청\r\n */\r\nexport async function apiDelete<T>(endpoint: string): Promise<ApiResponse<T>> {\r\n  return apiRequest<T>(endpoint, { method: 'DELETE' });\r\n}\r\n\r\n/**\r\n * 에러 처리 유틸리티\r\n */\r\nexport function handleApiError(error: any, defaultMessage: string = '작업에 실패했습니다'): string {\r\n  if (error?.response?.data?.detail) {\r\n    return error.response.data.detail;\r\n  }\r\n  if (error?.message) {\r\n    return error.message;\r\n  }\r\n  return defaultMessage;\r\n}\r\n\r\n/**\r\n * 저장고 관리를 위한 제네릭 클래스\r\n */\r\nexport class VaultManager<T, CreateRequest, UpdateRequest = Partial<CreateRequest>> {\r\n  constructor(private baseEndpoint: string) {}\r\n\r\n  async getAll(): Promise<ApiResponse<T[]>> {\r\n    return apiGet<T[]>(this.baseEndpoint);\r\n  }\r\n\r\n  async create(request: CreateRequest): Promise<ApiResponse<{ success: boolean; message: string; saved_item?: T }>> {\r\n    return apiPost(this.baseEndpoint, request);\r\n  }\r\n\r\n  async delete(id: string): Promise<ApiResponse<{ success: boolean; message: string }>> {\r\n    return apiDelete(`${this.baseEndpoint}/${id}`);\r\n  }\r\n\r\n  async update(id: string, request: UpdateRequest): Promise<ApiResponse<{ success: boolean; message: string; updated_item?: T }>> {\r\n    return apiPut(`${this.baseEndpoint}/${id}`, request);\r\n  }\r\n\r\n  async interact(id: string, request: any = {}): Promise<ApiResponse<any>> {\r\n    return apiPost(`${this.baseEndpoint}/${id}/interact`, request);\r\n  }\r\n}\r\n\r\n/**\r\n * 통합 채팅 함수\r\n */\r\nexport interface ChatRequest {\r\n  personaId: string;\r\n  message: string;\r\n  contextType?: 'interpretation' | 'proceed' | 'sentence' | 'verbalization';\r\n  contextContent?: string;\r\n  threadId?: string;\r\n  conversationId?: string;\r\n}\r\n\r\nexport async function universalChat(request: ChatRequest): Promise<ApiResponse<any>> {\r\n  const { personaId, message, contextType, contextContent, threadId, conversationId } = request;\r\n\r\n  // 채팅 타입에 따른 엔드포인트 결정\r\n  if (contextType === 'verbalization') {\r\n    return apiPost('/verbalization/chat', {\r\n      user_message: message,\r\n      thread_id: threadId\r\n    });\r\n  } else if (threadId) {\r\n    return apiPost('/threads/chat', {\r\n      thread_id: threadId,\r\n      user_message: message\r\n    });\r\n  } else if (contextType && contextContent) {\r\n    return apiPost('/chat/with-context', {\r\n      persona_id: personaId,\r\n      user_message: message,\r\n      context_type: contextType,\r\n      context_content: contextContent,\r\n      thread_id: threadId\r\n    });\r\n  } else if (conversationId) {\r\n    return apiPost('/chat/continue', {\r\n      persona_id: personaId,\r\n      user_message: message,\r\n      conversation_id: conversationId\r\n    });\r\n  } else {\r\n    return apiPost('/chat/initial', { content: message });\r\n  }\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}