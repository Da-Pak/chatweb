{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sungh\\\\Desktop\\\\chat_work_ver2\\\\frontend\\\\src\\\\features\\\\vault\\\\components\\\\MemoVaultView.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport styled from 'styled-components';\nimport { sentenceApi } from '../../training/api/sentenceApi';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n`;\n_c = Container;\nconst Header = styled.div`\n  padding: 20px;\n  border-bottom: 1px solid #e9ecef;\n  background: #fff;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 10px;\n`;\n_c2 = Header;\nconst FilterDropdownButton = styled.button`\n  background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);\n  border: 1px solid #dee2e6;\n  border-radius: 8px;\n  padding: 8px 16px;\n  cursor: pointer;\n  font-size: 14px;\n  color: #333;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  min-width: 120px;\n  justify-content: space-between;\n  \n  &:hover {\n    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n  }\n  \n  .arrow {\n    font-size: 12px;\n    transition: transform 0.2s;\n    transform: ${props => props.$isOpen ? 'rotate(180deg)' : 'rotate(0deg)'};\n  }\n`;\n_c3 = FilterDropdownButton;\nconst FilterDropdownMenu = styled.div`\n  position: absolute;\n  top: 100%;\n  left: 50%;\n  transform: translateX(-50%);\n  background: #f8f9fa;\n  border: 1px solid #dee2e6;\n  border-radius: 8px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  z-index: 1000;\n  max-height: 200px;\n  overflow-y: auto;\n  display: ${props => props.$isOpen ? 'block' : 'none'};\n  margin-top: 4px;\n  min-width: 150px;\n`;\n_c4 = FilterDropdownMenu;\nconst FilterDropdownItem = styled.div`\n  padding: 8px 16px;\n  cursor: pointer;\n  color: #333;\n  background: ${props => props.$isSelected ? '#e9ecef' : 'transparent'};\n  font-weight: ${props => props.$isSelected ? '500' : 'normal'};\n  \n  &:hover {\n    background: #e9ecef;\n  }\n  \n  &:first-child {\n    border-radius: 8px 8px 0 0;\n  }\n  \n  &:last-child {\n    border-radius: 0 0 8px 8px;\n  }\n`;\n_c5 = FilterDropdownItem;\nconst FilterContainer = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n`;\n_c6 = FilterContainer;\nconst NavigationButton = styled.button`\n  background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);\n  border: 1px solid #dee2e6;\n  border-radius: 50%;\n  width: 32px;\n  height: 32px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 14px;\n  color: #333;\n  \n  &:hover {\n    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n  }\n  \n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n`;\n_c7 = NavigationButton;\nconst ContentArea = styled.div`\n  flex: 1;\n  padding: 20px;\n  overflow-y: auto;\n  background: #ffffff;\n`;\n_c8 = ContentArea;\nconst MemoGrid = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n`;\n_c9 = MemoGrid;\nconst MemoItemWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n`;\n_c0 = MemoItemWrapper;\nconst MemoContent = styled.div`\n  width: 100%;\n  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n  border: 1px solid #dee2e6;\n  border-radius: 16px;\n  padding: 16px 20px;\n  cursor: pointer;\n  position: relative;\n  transition: all 0.2s ease;\n  min-height: 90px;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  \n  &:hover {\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n    transform: translateY(-1px);\n    border-color: #adb5bd;\n    background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);\n  }\n`;\n_c1 = MemoContent;\nconst MemoInnerContent = styled.div`\n  flex: 1;\n  background: rgba(108, 117, 125, 0.1);\n  border-radius: 8px;\n  padding: 12px 16px;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n`;\nconst UserMemoContent = styled.div`\n  font-size: 15px;\n  line-height: 1.6;\n  color: #333;\n  word-break: break-word;\n  font-weight: 600;\n`;\n_c10 = UserMemoContent;\nconst SentenceContent = styled.div`\n  font-size: 14px;\n  line-height: 1.5;\n  color: #555;\n  word-break: break-word;\n  font-style: italic;\n  \n  &::before {\n    content: \"↘ \";\n    color: #999;\n    font-weight: bold;\n    margin-right: 4px;\n  }\n`;\n_c11 = SentenceContent;\nconst MemoMeta = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  font-size: 12px;\n  color: #6c757d;\n  gap: 8px;\n`;\n_c12 = MemoMeta;\nconst ThreadTypeLabel = styled.span`\n  background: #e9ecef;\n  padding: 3px 8px;\n  border-radius: 6px;\n  font-weight: 500;\n  color: #495057;\n`;\n_c13 = ThreadTypeLabel;\nconst DateLabel = styled.span`\n  font-style: italic;\n  opacity: 0.8;\n`;\n_c14 = DateLabel;\nconst EmptyState = styled.div`\n  text-align: center;\n  padding: 60px 20px;\n  color: #6c757d;\n  \n  .icon {\n    font-size: 48px;\n    margin-bottom: 16px;\n  }\n  \n  .title {\n    font-size: 18px;\n    font-weight: 500;\n    margin-bottom: 8px;\n  }\n  \n  .description {\n    font-size: 14px;\n  }\n`;\n_c15 = EmptyState;\nconst ContextMenuContainer = styled.div`\n  position: fixed;\n  top: ${props => props.$y}px;\n  left: ${props => props.$x}px;\n  background: white;\n  border: 1px solid #dee2e6;\n  border-radius: 8px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  z-index: 1000;\n  min-width: 160px;\n  overflow: hidden;\n`;\n_c16 = ContextMenuContainer;\nconst ContextMenuItem = styled.div`\n  padding: 12px 16px;\n  cursor: pointer;\n  font-size: 14px;\n  color: #333;\n  \n  &:hover {\n    background-color: #f8f9fa;\n  }\n  \n  &:not(:last-child) {\n    border-bottom: 1px solid #f1f3f4;\n  }\n`;\n_c17 = ContextMenuItem;\nconst ModalOverlay = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 2000;\n`;\n_c18 = ModalOverlay;\nconst ModalContent = styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 24px;\n  max-width: 400px;\n  width: 90%;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);\n`;\n_c19 = ModalContent;\nconst ModalTitle = styled.h3`\n  margin: 0 0 16px 0;\n  font-size: 18px;\n  font-weight: 600;\n  color: #333;\n`;\n_c20 = ModalTitle;\nconst ModalMessage = styled.p`\n  margin: 0 0 24px 0;\n  font-size: 14px;\n  color: #666;\n  line-height: 1.5;\n`;\n_c21 = ModalMessage;\nconst ModalButtons = styled.div`\n  display: flex;\n  gap: 12px;\n  justify-content: space-between;\n`;\n_c22 = ModalButtons;\nconst ModalButton = styled.button`\n  padding: 10px 20px;\n  border-radius: 6px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  border: 1px solid;\n  \n  ${props => props.$variant === 'primary' ? `\n    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n    color: #495057;\n    border-color: #adb5bd;\n    \n    &:hover {\n      background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);\n      border-color: #6c757d;\n    }\n  ` : `\n    background: white;\n    color: #6c757d;\n    border-color: #dee2e6;\n    \n    &:hover {\n      background: #f8f9fa;\n    }\n  `}\n`;\n_c23 = ModalButton;\nconst MemoVaultView = ({\n  personas,\n  onNavigateToThread\n}) => {\n  _s();\n  const [memos, setMemos] = useState([]);\n  const [filteredMemos, setFilteredMemos] = useState([]);\n  const [currentFilter, setCurrentFilter] = useState('전체');\n  const [loading, setLoading] = useState(true);\n  const [contextMenu, setContextMenu] = useState(null);\n  const [confirmationModal, setConfirmationModal] = useState(null);\n  const [showFilterDropdown, setShowFilterDropdown] = useState(false);\n\n  // 필터 옵션들\n  const [filterOptions, setFilterOptions] = useState(['전체', '해석', '나아가기', '문장', '언어화']);\n  const [currentFilterIndex, setCurrentFilterIndex] = useState(0);\n  const loadMemos = useCallback(async () => {\n    try {\n      setLoading(true);\n      const data = await sentenceApi.getVaultMemos();\n      console.log('=== 메모 저장고 로드된 데이터 ===');\n      console.log('총 메모 개수:', data.length);\n      console.log('최근 5개 메모:', data.slice(0, 5));\n      data.slice(0, 5).forEach((memo, index) => {\n        var _memo$memo_content;\n        console.log(`메모 ${index + 1}:`, {\n          id: memo.id,\n          source_message_id: memo.source_message_id,\n          tags: memo.tags,\n          source_thread_type: memo.source_thread_type,\n          memo_content: ((_memo$memo_content = memo.memo_content) === null || _memo$memo_content === void 0 ? void 0 : _memo$memo_content.substring(0, 30)) + '...'\n        });\n      });\n      setMemos(data);\n\n      // 필터 옵션에 페르소나들 추가\n      const personaNames = Object.values(personas).map(p => p.name);\n      setFilterOptions(['전체', '해석', '나아가기', '문장', '언어화', ...personaNames]);\n    } catch (error) {\n      console.error('메모 저장고 로딩 실패:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [personas]);\n  const applyFilter = useCallback(() => {\n    let filtered = [...memos];\n    if (currentFilter !== '전체') {\n      if (currentFilter === '해석') {\n        filtered = filtered.filter(m => m.source_thread_type === 'interpretation');\n      } else if (currentFilter === '나아가기') {\n        filtered = filtered.filter(m => m.source_thread_type === 'proceed');\n      } else if (currentFilter === '문장') {\n        filtered = filtered.filter(m => m.source_thread_type === 'sentence');\n      } else if (currentFilter === '언어화') {\n        filtered = filtered.filter(m => m.source_thread_type === 'verbalization');\n      } else {\n        // 페르소나 이름으로 필터링\n        const personaId = Object.keys(personas).find(id => personas[id].name === currentFilter);\n        if (personaId) {\n          filtered = filtered.filter(m => {\n            var _m$source_message_id;\n            return m.tags.includes(personaId) || ((_m$source_message_id = m.source_message_id) === null || _m$source_message_id === void 0 ? void 0 : _m$source_message_id.includes(personaId));\n          });\n        }\n      }\n    }\n\n    // 날짜순 정렬 (최신순)\n    filtered.sort((a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime());\n    setFilteredMemos(filtered);\n  }, [memos, currentFilter, personas]);\n  useEffect(() => {\n    loadMemos();\n  }, [loadMemos]);\n  useEffect(() => {\n    applyFilter();\n  }, [memos, currentFilter, applyFilter]);\n\n  // 드롭다운 외부 클릭 감지\n  useEffect(() => {\n    const handleClickOutside = event => {\n      const target = event.target;\n      if (!target.closest('.filter-dropdown')) {\n        setShowFilterDropdown(false);\n      }\n    };\n    if (showFilterDropdown) {\n      document.addEventListener('click', handleClickOutside);\n      return () => document.removeEventListener('click', handleClickOutside);\n    }\n  }, [showFilterDropdown]);\n\n  // 컨텍스트 메뉴 외부 클릭 감지\n  useEffect(() => {\n    const handleClickOutside = () => {\n      setContextMenu(null);\n    };\n    if (contextMenu) {\n      document.addEventListener('click', handleClickOutside);\n      return () => document.removeEventListener('click', handleClickOutside);\n    }\n  }, [contextMenu]);\n  const handleFilterChange = filter => {\n    setCurrentFilter(filter);\n    setCurrentFilterIndex(filterOptions.indexOf(filter));\n    setShowFilterDropdown(false);\n  };\n  const handleNavigateFilter = direction => {\n    const newIndex = direction === 'prev' ? Math.max(0, currentFilterIndex - 1) : Math.min(filterOptions.length - 1, currentFilterIndex + 1);\n    setCurrentFilterIndex(newIndex);\n    setCurrentFilter(filterOptions[newIndex]);\n  };\n  const toggleFilterDropdown = () => {\n    setShowFilterDropdown(!showFilterDropdown);\n  };\n  const handleMemoClick = (e, memo) => {\n    e.preventDefault();\n    e.stopPropagation();\n    console.log('메모 클릭됨:', memo.memo_content.substring(0, 50));\n    console.log('클릭 위치:', e.clientX, e.clientY);\n    setContextMenu({\n      x: e.clientX,\n      y: e.clientY,\n      memo\n    });\n    console.log('컨텍스트 메뉴 설정됨');\n  };\n  const handleContextMenuAction = async (action, memo) => {\n    console.log('컨텍스트 메뉴 액션:', action);\n    setContextMenu(null);\n    if (action === 'interact') {\n      setConfirmationModal({\n        type: 'interact',\n        memo\n      });\n    } else if (action === 'delete') {\n      setConfirmationModal({\n        type: 'delete',\n        memo\n      });\n    }\n  };\n  const handleConfirmAction = async () => {\n    if (!confirmationModal) return;\n    try {\n      if (confirmationModal.type === 'interact') {\n        const response = await sentenceApi.interactWithVaultMemo(confirmationModal.memo.id);\n        if (response.success && response.source_thread_id && response.source_thread_type) {\n          // 원본 스레드로 이동하면서 상호작용 메시지 전달\n          onNavigateToThread(response.source_thread_id, response.source_thread_type, response.interaction_message);\n        }\n      } else if (confirmationModal.type === 'delete') {\n        await sentenceApi.deleteVaultMemo(confirmationModal.memo.id);\n        await loadMemos(); // 목록 새로고침\n      }\n    } catch (error) {\n      console.error('메모 액션 실패:', error);\n    } finally {\n      setConfirmationModal(null);\n    }\n  };\n  const formatDate = dateString => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('ko-KR', {\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n  const getThreadTypeLabel = threadType => {\n    switch (threadType) {\n      case 'interpretation':\n        return '해석';\n      case 'proceed':\n        return '나아가기';\n      case 'sentence':\n        return '문장';\n      case 'verbalization':\n        return '언어화';\n      default:\n        return threadType || '알수없음';\n    }\n  };\n  const getPersonaName = memo => {\n    // source_message_id에서 페르소나 ID 추출 및 복원 시도\n    if (memo.source_message_id) {\n      const parts = memo.source_message_id.split('_');\n      if (parts.length > 1) {\n        // 완전한 페르소나 ID 복원 시도 (예: sigmund -> sigmund_freud)\n        let personaId = parts[1];\n\n        // 직접 매칭 시도\n        if (personas[personaId]) {\n          return personas[personaId].name;\n        }\n\n        // 부분 매칭으로 완전한 페르소나 ID 찾기\n        const matchingPersonaId = Object.keys(personas).find(id => id.startsWith(personaId + '_'));\n        if (matchingPersonaId) {\n          return personas[matchingPersonaId].name;\n        }\n      }\n    }\n\n    // tags에서 페르소나 찾기 (thread_type이 아닌 것들만)\n    const excludeTypes = ['interpretation', 'proceed', 'sentence', 'verbalization'];\n    for (const tag of memo.tags) {\n      if (!excludeTypes.includes(tag)) {\n        // 직접 매칭 시도\n        if (personas[tag]) {\n          return personas[tag].name;\n        }\n\n        // 부분 매칭으로 완전한 페르소나 ID 찾기\n        const matchingPersonaId = Object.keys(personas).find(id => id.startsWith(tag + '_'));\n        if (matchingPersonaId) {\n          return personas[matchingPersonaId].name;\n        }\n      }\n    }\n\n    // 언어화 특별 처리\n    if (memo.source_message_id === 'verbalization_chat' || memo.source_thread_type === 'verbalization' || memo.tags.includes('verbalization')) {\n      return '언어화';\n    }\n    return '알수없음';\n  };\n  const getModalContent = () => {\n    if (!confirmationModal) return null;\n    const {\n      type\n    } = confirmationModal;\n    switch (type) {\n      case 'interact':\n        return {\n          title: '메모 상호작용',\n          message: `이 메모와 상호작용하시겠습니까? 원본 위치로 이동하여 \"${confirmationModal.memo.sentence_content} - ${confirmationModal.memo.memo_content}\" 형식으로 입력창에 삽입됩니다.`,\n          confirmText: '상호작용',\n          cancelText: '취소'\n        };\n      case 'delete':\n        return {\n          title: '메모 삭제',\n          message: '이 메모를 삭제하시겠습니까? 삭제된 메모는 복구할 수 없습니다.',\n          confirmText: '삭제',\n          cancelText: '취소'\n        };\n      default:\n        return null;\n    }\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: '40px',\n          textAlign: 'center'\n        },\n        children: \"\\uB85C\\uB529 \\uC911...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 629,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 628,\n      columnNumber: 7\n    }, this);\n  }\n  const modalContent = getModalContent();\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      children: [/*#__PURE__*/_jsxDEV(NavigationButton, {\n        onClick: () => handleNavigateFilter('prev'),\n        disabled: currentFilterIndex === 0,\n        children: \"\\u2039\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 641,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(FilterContainer, {\n        className: \"filter-dropdown\",\n        children: [/*#__PURE__*/_jsxDEV(FilterDropdownButton, {\n          $isOpen: showFilterDropdown,\n          onClick: toggleFilterDropdown,\n          children: [currentFilter, /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"arrow\",\n            children: \"\\u25BC\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 654,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 649,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FilterDropdownMenu, {\n          $isOpen: showFilterDropdown,\n          children: filterOptions.map(option => /*#__PURE__*/_jsxDEV(FilterDropdownItem, {\n            $isSelected: option === currentFilter,\n            onClick: () => handleFilterChange(option),\n            children: option\n          }, option, false, {\n            fileName: _jsxFileName,\n            lineNumber: 658,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 656,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 648,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(NavigationButton, {\n        onClick: () => handleNavigateFilter('next'),\n        disabled: currentFilterIndex === filterOptions.length - 1,\n        children: \"\\u203A\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 669,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 640,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ContentArea, {\n      children: filteredMemos.length === 0 ? /*#__PURE__*/_jsxDEV(EmptyState, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"icon\",\n          children: \"\\uD83D\\uDCDD\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 680,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"title\",\n          children: \"\\uC800\\uC7A5\\uB41C \\uBA54\\uBAA8\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 681,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"description\",\n          children: \"\\uD6C8\\uC2B5\\uC774\\uB098 \\uC5B8\\uC5B4\\uD654 \\uD398\\uC774\\uC9C0\\uC5D0\\uC11C \\uBA54\\uBAA8\\uB97C \\uC0DD\\uC131\\uD558\\uBA74 \\uC790\\uB3D9\\uC73C\\uB85C \\uC800\\uC7A5\\uB429\\uB2C8\\uB2E4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 682,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 679,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(MemoGrid, {\n        children: filteredMemos.map(memo => /*#__PURE__*/_jsxDEV(MemoItemWrapper, {\n          children: [/*#__PURE__*/_jsxDEV(MemoContent, {\n            onClick: e => handleMemoClick(e, memo),\n            children: [/*#__PURE__*/_jsxDEV(UserMemoContent, {\n              children: memo.memo_content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 691,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(SentenceContent, {\n              children: memo.sentence_content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 692,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 690,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(MemoMeta, {\n            children: [/*#__PURE__*/_jsxDEV(ThreadTypeLabel, {\n              children: [getPersonaName(memo), \" - \", getThreadTypeLabel(memo.source_thread_type)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 695,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(DateLabel, {\n              children: formatDate(memo.created_at)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 698,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 694,\n            columnNumber: 17\n          }, this)]\n        }, memo.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 689,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 687,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 677,\n      columnNumber: 7\n    }, this), contextMenu && /*#__PURE__*/_jsxDEV(ContextMenuContainer, {\n      $x: contextMenu.x,\n      $y: contextMenu.y,\n      children: [/*#__PURE__*/_jsxDEV(ContextMenuItem, {\n        onClick: () => handleContextMenuAction('interact', contextMenu.memo),\n        children: \"\\uC0C1\\uD638\\uC791\\uC6A9 \\uD558\\uAE30\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 711,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(ContextMenuItem, {\n        onClick: () => handleContextMenuAction('delete', contextMenu.memo),\n        children: \"\\uC0AD\\uC81C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 716,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 710,\n      columnNumber: 9\n    }, this), confirmationModal && modalContent && /*#__PURE__*/_jsxDEV(ModalOverlay, {\n      onClick: () => setConfirmationModal(null),\n      children: /*#__PURE__*/_jsxDEV(ModalContent, {\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(ModalTitle, {\n          children: modalContent.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 728,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(ModalMessage, {\n          children: modalContent.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 729,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(ModalButtons, {\n          children: [/*#__PURE__*/_jsxDEV(ModalButton, {\n            $variant: \"primary\",\n            onClick: handleConfirmAction,\n            children: modalContent.confirmText\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 731,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(ModalButton, {\n            $variant: \"secondary\",\n            onClick: () => setConfirmationModal(null),\n            children: modalContent.cancelText\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 737,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 730,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 727,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 726,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 639,\n    columnNumber: 5\n  }, this);\n};\n_s(MemoVaultView, \"ci8LGWfZYs/1XqHlQoP0tSPQHUE=\");\n_c24 = MemoVaultView;\nexport default MemoVaultView;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c0, _c1, _c10, _c11, _c12, _c13, _c14, _c15, _c16, _c17, _c18, _c19, _c20, _c21, _c22, _c23, _c24;\n$RefreshReg$(_c, \"Container\");\n$RefreshReg$(_c2, \"Header\");\n$RefreshReg$(_c3, \"FilterDropdownButton\");\n$RefreshReg$(_c4, \"FilterDropdownMenu\");\n$RefreshReg$(_c5, \"FilterDropdownItem\");\n$RefreshReg$(_c6, \"FilterContainer\");\n$RefreshReg$(_c7, \"NavigationButton\");\n$RefreshReg$(_c8, \"ContentArea\");\n$RefreshReg$(_c9, \"MemoGrid\");\n$RefreshReg$(_c0, \"MemoItemWrapper\");\n$RefreshReg$(_c1, \"MemoContent\");\n$RefreshReg$(_c10, \"UserMemoContent\");\n$RefreshReg$(_c11, \"SentenceContent\");\n$RefreshReg$(_c12, \"MemoMeta\");\n$RefreshReg$(_c13, \"ThreadTypeLabel\");\n$RefreshReg$(_c14, \"DateLabel\");\n$RefreshReg$(_c15, \"EmptyState\");\n$RefreshReg$(_c16, \"ContextMenuContainer\");\n$RefreshReg$(_c17, \"ContextMenuItem\");\n$RefreshReg$(_c18, \"ModalOverlay\");\n$RefreshReg$(_c19, \"ModalContent\");\n$RefreshReg$(_c20, \"ModalTitle\");\n$RefreshReg$(_c21, \"ModalMessage\");\n$RefreshReg$(_c22, \"ModalButtons\");\n$RefreshReg$(_c23, \"ModalButton\");\n$RefreshReg$(_c24, \"MemoVaultView\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","styled","sentenceApi","jsxDEV","_jsxDEV","Container","div","_c","Header","_c2","FilterDropdownButton","button","props","$isOpen","_c3","FilterDropdownMenu","_c4","FilterDropdownItem","$isSelected","_c5","FilterContainer","_c6","NavigationButton","_c7","ContentArea","_c8","MemoGrid","_c9","MemoItemWrapper","_c0","MemoContent","_c1","MemoInnerContent","UserMemoContent","_c10","SentenceContent","_c11","MemoMeta","_c12","ThreadTypeLabel","span","_c13","DateLabel","_c14","EmptyState","_c15","ContextMenuContainer","$y","$x","_c16","ContextMenuItem","_c17","ModalOverlay","_c18","ModalContent","_c19","ModalTitle","h3","_c20","ModalMessage","p","_c21","ModalButtons","_c22","ModalButton","$variant","_c23","MemoVaultView","personas","onNavigateToThread","_s","memos","setMemos","filteredMemos","setFilteredMemos","currentFilter","setCurrentFilter","loading","setLoading","contextMenu","setContextMenu","confirmationModal","setConfirmationModal","showFilterDropdown","setShowFilterDropdown","filterOptions","setFilterOptions","currentFilterIndex","setCurrentFilterIndex","loadMemos","data","getVaultMemos","console","log","length","slice","forEach","memo","index","_memo$memo_content","id","source_message_id","tags","source_thread_type","memo_content","substring","personaNames","Object","values","map","name","error","applyFilter","filtered","filter","m","personaId","keys","find","_m$source_message_id","includes","sort","a","b","Date","created_at","getTime","handleClickOutside","event","target","closest","document","addEventListener","removeEventListener","handleFilterChange","indexOf","handleNavigateFilter","direction","newIndex","Math","max","min","toggleFilterDropdown","handleMemoClick","e","preventDefault","stopPropagation","clientX","clientY","x","y","handleContextMenuAction","action","type","handleConfirmAction","response","interactWithVaultMemo","success","source_thread_id","interaction_message","deleteVaultMemo","formatDate","dateString","date","toLocaleDateString","month","day","hour","minute","getThreadTypeLabel","threadType","getPersonaName","parts","split","matchingPersonaId","startsWith","excludeTypes","tag","getModalContent","title","message","sentence_content","confirmText","cancelText","children","style","padding","textAlign","fileName","_jsxFileName","lineNumber","columnNumber","modalContent","onClick","disabled","className","option","_c24","$RefreshReg$"],"sources":["C:/Users/sungh/Desktop/chat_work_ver2/frontend/src/features/vault/components/MemoVaultView.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport styled from 'styled-components';\nimport { sentenceApi, MemoVaultItem } from '../../training/api/sentenceApi';\nimport { Persona } from '../../shared/types';\n\ninterface MemoVaultViewProps {\n  personas: Record<string, Persona>;\n  onNavigateToThread: (threadId: string, threadType: string, interactionMessage?: string) => void;\n}\n\ninterface ContextMenu {\n  x: number;\n  y: number;\n  memo: MemoVaultItem;\n}\n\ninterface ConfirmationModalData {\n  type: 'interact' | 'delete';\n  memo: MemoVaultItem;\n}\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n`;\n\nconst Header = styled.div`\n  padding: 20px;\n  border-bottom: 1px solid #e9ecef;\n  background: #fff;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 10px;\n`;\n\nconst FilterDropdownButton = styled.button<{ $isOpen: boolean }>`\n  background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);\n  border: 1px solid #dee2e6;\n  border-radius: 8px;\n  padding: 8px 16px;\n  cursor: pointer;\n  font-size: 14px;\n  color: #333;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  min-width: 120px;\n  justify-content: space-between;\n  \n  &:hover {\n    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n  }\n  \n  .arrow {\n    font-size: 12px;\n    transition: transform 0.2s;\n    transform: ${props => props.$isOpen ? 'rotate(180deg)' : 'rotate(0deg)'};\n  }\n`;\n\nconst FilterDropdownMenu = styled.div<{ $isOpen: boolean }>`\n  position: absolute;\n  top: 100%;\n  left: 50%;\n  transform: translateX(-50%);\n  background: #f8f9fa;\n  border: 1px solid #dee2e6;\n  border-radius: 8px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  z-index: 1000;\n  max-height: 200px;\n  overflow-y: auto;\n  display: ${props => props.$isOpen ? 'block' : 'none'};\n  margin-top: 4px;\n  min-width: 150px;\n`;\n\nconst FilterDropdownItem = styled.div<{ $isSelected: boolean }>`\n  padding: 8px 16px;\n  cursor: pointer;\n  color: #333;\n  background: ${props => props.$isSelected ? '#e9ecef' : 'transparent'};\n  font-weight: ${props => props.$isSelected ? '500' : 'normal'};\n  \n  &:hover {\n    background: #e9ecef;\n  }\n  \n  &:first-child {\n    border-radius: 8px 8px 0 0;\n  }\n  \n  &:last-child {\n    border-radius: 0 0 8px 8px;\n  }\n`;\n\nconst FilterContainer = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n`;\n\nconst NavigationButton = styled.button`\n  background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);\n  border: 1px solid #dee2e6;\n  border-radius: 50%;\n  width: 32px;\n  height: 32px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 14px;\n  color: #333;\n  \n  &:hover {\n    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n  }\n  \n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n`;\n\nconst ContentArea = styled.div`\n  flex: 1;\n  padding: 20px;\n  overflow-y: auto;\n  background: #ffffff;\n`;\n\nconst MemoGrid = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n`;\n\nconst MemoItemWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n`;\n\nconst MemoContent = styled.div`\n  width: 100%;\n  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n  border: 1px solid #dee2e6;\n  border-radius: 16px;\n  padding: 16px 20px;\n  cursor: pointer;\n  position: relative;\n  transition: all 0.2s ease;\n  min-height: 90px;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  \n  &:hover {\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n    transform: translateY(-1px);\n    border-color: #adb5bd;\n    background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);\n  }\n`;\n\nconst MemoInnerContent = styled.div`\n  flex: 1;\n  background: rgba(108, 117, 125, 0.1);\n  border-radius: 8px;\n  padding: 12px 16px;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n`;\n\nconst UserMemoContent = styled.div`\n  font-size: 15px;\n  line-height: 1.6;\n  color: #333;\n  word-break: break-word;\n  font-weight: 600;\n`;\n\nconst SentenceContent = styled.div`\n  font-size: 14px;\n  line-height: 1.5;\n  color: #555;\n  word-break: break-word;\n  font-style: italic;\n  \n  &::before {\n    content: \"↘ \";\n    color: #999;\n    font-weight: bold;\n    margin-right: 4px;\n  }\n`;\n\nconst MemoMeta = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  font-size: 12px;\n  color: #6c757d;\n  gap: 8px;\n`;\n\nconst ThreadTypeLabel = styled.span`\n  background: #e9ecef;\n  padding: 3px 8px;\n  border-radius: 6px;\n  font-weight: 500;\n  color: #495057;\n`;\n\nconst DateLabel = styled.span`\n  font-style: italic;\n  opacity: 0.8;\n`;\n\nconst EmptyState = styled.div`\n  text-align: center;\n  padding: 60px 20px;\n  color: #6c757d;\n  \n  .icon {\n    font-size: 48px;\n    margin-bottom: 16px;\n  }\n  \n  .title {\n    font-size: 18px;\n    font-weight: 500;\n    margin-bottom: 8px;\n  }\n  \n  .description {\n    font-size: 14px;\n  }\n`;\n\nconst ContextMenuContainer = styled.div<{ $x: number; $y: number }>`\n  position: fixed;\n  top: ${props => props.$y}px;\n  left: ${props => props.$x}px;\n  background: white;\n  border: 1px solid #dee2e6;\n  border-radius: 8px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  z-index: 1000;\n  min-width: 160px;\n  overflow: hidden;\n`;\n\nconst ContextMenuItem = styled.div`\n  padding: 12px 16px;\n  cursor: pointer;\n  font-size: 14px;\n  color: #333;\n  \n  &:hover {\n    background-color: #f8f9fa;\n  }\n  \n  &:not(:last-child) {\n    border-bottom: 1px solid #f1f3f4;\n  }\n`;\n\nconst ModalOverlay = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 2000;\n`;\n\nconst ModalContent = styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 24px;\n  max-width: 400px;\n  width: 90%;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);\n`;\n\nconst ModalTitle = styled.h3`\n  margin: 0 0 16px 0;\n  font-size: 18px;\n  font-weight: 600;\n  color: #333;\n`;\n\nconst ModalMessage = styled.p`\n  margin: 0 0 24px 0;\n  font-size: 14px;\n  color: #666;\n  line-height: 1.5;\n`;\n\nconst ModalButtons = styled.div`\n  display: flex;\n  gap: 12px;\n  justify-content: space-between;\n`;\n\nconst ModalButton = styled.button<{ $variant: 'primary' | 'secondary' }>`\n  padding: 10px 20px;\n  border-radius: 6px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  border: 1px solid;\n  \n  ${props => props.$variant === 'primary' ? `\n    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n    color: #495057;\n    border-color: #adb5bd;\n    \n    &:hover {\n      background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);\n      border-color: #6c757d;\n    }\n  ` : `\n    background: white;\n    color: #6c757d;\n    border-color: #dee2e6;\n    \n    &:hover {\n      background: #f8f9fa;\n    }\n  `}\n`;\n\n\n\nconst MemoVaultView: React.FC<MemoVaultViewProps> = ({\n  personas,\n  onNavigateToThread\n}) => {\n  const [memos, setMemos] = useState<MemoVaultItem[]>([]);\n  const [filteredMemos, setFilteredMemos] = useState<MemoVaultItem[]>([]);\n  const [currentFilter, setCurrentFilter] = useState<string>('전체');\n  const [loading, setLoading] = useState(true);\n  const [contextMenu, setContextMenu] = useState<ContextMenu | null>(null);\n  const [confirmationModal, setConfirmationModal] = useState<ConfirmationModalData | null>(null);\n  const [showFilterDropdown, setShowFilterDropdown] = useState(false);\n  \n  // 필터 옵션들\n  const [filterOptions, setFilterOptions] = useState<string[]>(['전체', '해석', '나아가기', '문장', '언어화']);\n  const [currentFilterIndex, setCurrentFilterIndex] = useState(0);\n\n  const loadMemos = useCallback(async () => {\n    try {\n      setLoading(true);\n      const data = await sentenceApi.getVaultMemos();\n      console.log('=== 메모 저장고 로드된 데이터 ===');\n      console.log('총 메모 개수:', data.length);\n      console.log('최근 5개 메모:', data.slice(0, 5));\n      data.slice(0, 5).forEach((memo, index) => {\n        console.log(`메모 ${index + 1}:`, {\n          id: memo.id,\n          source_message_id: memo.source_message_id,\n          tags: memo.tags,\n          source_thread_type: memo.source_thread_type,\n          memo_content: memo.memo_content?.substring(0, 30) + '...'\n        });\n      });\n      \n      setMemos(data);\n      \n      // 필터 옵션에 페르소나들 추가\n      const personaNames = Object.values(personas).map(p => p.name);\n      setFilterOptions(['전체', '해석', '나아가기', '문장', '언어화', ...personaNames]);\n    } catch (error) {\n      console.error('메모 저장고 로딩 실패:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [personas]);\n\n  const applyFilter = useCallback(() => {\n    let filtered = [...memos];\n\n    if (currentFilter !== '전체') {\n      if (currentFilter === '해석') {\n        filtered = filtered.filter(m => m.source_thread_type === 'interpretation');\n      } else if (currentFilter === '나아가기') {\n        filtered = filtered.filter(m => m.source_thread_type === 'proceed');\n      } else if (currentFilter === '문장') {\n        filtered = filtered.filter(m => m.source_thread_type === 'sentence');\n      } else if (currentFilter === '언어화') {\n        filtered = filtered.filter(m => m.source_thread_type === 'verbalization');\n      } else {\n        // 페르소나 이름으로 필터링\n        const personaId = Object.keys(personas).find(id => personas[id].name === currentFilter);\n        if (personaId) {\n          filtered = filtered.filter(m => m.tags.includes(personaId) || m.source_message_id?.includes(personaId));\n        }\n      }\n    }\n\n    // 날짜순 정렬 (최신순)\n    filtered.sort((a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime());\n\n    setFilteredMemos(filtered);\n  }, [memos, currentFilter, personas]);\n\n  useEffect(() => {\n    loadMemos();\n  }, [loadMemos]);\n\n  useEffect(() => {\n    applyFilter();\n  }, [memos, currentFilter, applyFilter]);\n\n  // 드롭다운 외부 클릭 감지\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      const target = event.target as Element;\n      if (!target.closest('.filter-dropdown')) {\n        setShowFilterDropdown(false);\n      }\n    };\n\n    if (showFilterDropdown) {\n      document.addEventListener('click', handleClickOutside);\n      return () => document.removeEventListener('click', handleClickOutside);\n    }\n  }, [showFilterDropdown]);\n\n  // 컨텍스트 메뉴 외부 클릭 감지\n  useEffect(() => {\n    const handleClickOutside = () => {\n      setContextMenu(null);\n    };\n\n    if (contextMenu) {\n      document.addEventListener('click', handleClickOutside);\n      return () => document.removeEventListener('click', handleClickOutside);\n    }\n  }, [contextMenu]);\n\n  const handleFilterChange = (filter: string) => {\n    setCurrentFilter(filter);\n    setCurrentFilterIndex(filterOptions.indexOf(filter));\n    setShowFilterDropdown(false);\n  };\n\n  const handleNavigateFilter = (direction: 'prev' | 'next') => {\n    const newIndex = direction === 'prev' \n      ? Math.max(0, currentFilterIndex - 1)\n      : Math.min(filterOptions.length - 1, currentFilterIndex + 1);\n    \n    setCurrentFilterIndex(newIndex);\n    setCurrentFilter(filterOptions[newIndex]);\n  };\n\n  const toggleFilterDropdown = () => {\n    setShowFilterDropdown(!showFilterDropdown);\n  };\n\n  const handleMemoClick = (e: React.MouseEvent, memo: MemoVaultItem) => {\n    e.preventDefault();\n    e.stopPropagation();\n    \n    console.log('메모 클릭됨:', memo.memo_content.substring(0, 50));\n    console.log('클릭 위치:', e.clientX, e.clientY);\n    \n    setContextMenu({\n      x: e.clientX,\n      y: e.clientY,\n      memo\n    });\n    \n    console.log('컨텍스트 메뉴 설정됨');\n  };\n\n  const handleContextMenuAction = async (action: 'interact' | 'delete', memo: MemoVaultItem) => {\n    console.log('컨텍스트 메뉴 액션:', action);\n    setContextMenu(null);\n    \n    if (action === 'interact') {\n      setConfirmationModal({\n        type: 'interact',\n        memo\n      });\n    } else if (action === 'delete') {\n      setConfirmationModal({\n        type: 'delete',\n        memo\n      });\n    }\n  };\n\n  const handleConfirmAction = async () => {\n    if (!confirmationModal) return;\n\n    try {\n      if (confirmationModal.type === 'interact') {\n        const response = await sentenceApi.interactWithVaultMemo(confirmationModal.memo.id);\n        \n        if (response.success && response.source_thread_id && response.source_thread_type) {\n          // 원본 스레드로 이동하면서 상호작용 메시지 전달\n          onNavigateToThread(\n            response.source_thread_id,\n            response.source_thread_type,\n            response.interaction_message\n          );\n        }\n      } else if (confirmationModal.type === 'delete') {\n        await sentenceApi.deleteVaultMemo(confirmationModal.memo.id);\n        await loadMemos(); // 목록 새로고침\n      }\n    } catch (error) {\n      console.error('메모 액션 실패:', error);\n    } finally {\n      setConfirmationModal(null);\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('ko-KR', {\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  const getThreadTypeLabel = (threadType?: string) => {\n    switch (threadType) {\n      case 'interpretation': return '해석';\n      case 'proceed': return '나아가기';\n      case 'sentence': return '문장';\n      case 'verbalization': return '언어화';\n      default: return threadType || '알수없음';\n    }\n  };\n\n  const getPersonaName = (memo: MemoVaultItem) => {\n    // source_message_id에서 페르소나 ID 추출 및 복원 시도\n    if (memo.source_message_id) {\n      const parts = memo.source_message_id.split('_');\n      if (parts.length > 1) {\n        // 완전한 페르소나 ID 복원 시도 (예: sigmund -> sigmund_freud)\n        let personaId = parts[1];\n        \n        // 직접 매칭 시도\n        if (personas[personaId]) {\n          return personas[personaId].name;\n        }\n        \n        // 부분 매칭으로 완전한 페르소나 ID 찾기\n        const matchingPersonaId = Object.keys(personas).find(id => id.startsWith(personaId + '_'));\n        if (matchingPersonaId) {\n          return personas[matchingPersonaId].name;\n        }\n      }\n    }\n    \n    // tags에서 페르소나 찾기 (thread_type이 아닌 것들만)\n    const excludeTypes = ['interpretation', 'proceed', 'sentence', 'verbalization'];\n    for (const tag of memo.tags) {\n      if (!excludeTypes.includes(tag)) {\n        // 직접 매칭 시도\n        if (personas[tag]) {\n          return personas[tag].name;\n        }\n        \n        // 부분 매칭으로 완전한 페르소나 ID 찾기\n        const matchingPersonaId = Object.keys(personas).find(id => id.startsWith(tag + '_'));\n        if (matchingPersonaId) {\n          return personas[matchingPersonaId].name;\n        }\n      }\n    }\n    \n    // 언어화 특별 처리\n    if (memo.source_message_id === 'verbalization_chat' || \n        memo.source_thread_type === 'verbalization' ||\n        memo.tags.includes('verbalization')) {\n      return '언어화';\n    }\n    \n    return '알수없음';\n  };\n\n  const getModalContent = () => {\n    if (!confirmationModal) return null;\n    \n    const { type } = confirmationModal;\n    \n    switch (type) {\n      case 'interact':\n        return {\n          title: '메모 상호작용',\n          message: `이 메모와 상호작용하시겠습니까? 원본 위치로 이동하여 \"${confirmationModal.memo.sentence_content} - ${confirmationModal.memo.memo_content}\" 형식으로 입력창에 삽입됩니다.`,\n          confirmText: '상호작용',\n          cancelText: '취소'\n        };\n      case 'delete':\n        return {\n          title: '메모 삭제',\n          message: '이 메모를 삭제하시겠습니까? 삭제된 메모는 복구할 수 없습니다.',\n          confirmText: '삭제',\n          cancelText: '취소'\n        };\n      default:\n        return null;\n    }\n  };\n\n  if (loading) {\n    return (\n      <Container>\n        <div style={{ padding: '40px', textAlign: 'center' }}>\n          로딩 중...\n        </div>\n      </Container>\n    );\n  }\n\n  const modalContent = getModalContent();\n\n  return (\n    <Container>\n      <Header>\n        <NavigationButton\n          onClick={() => handleNavigateFilter('prev')}\n          disabled={currentFilterIndex === 0}\n        >\n          ‹\n        </NavigationButton>\n        \n        <FilterContainer className=\"filter-dropdown\">\n          <FilterDropdownButton\n            $isOpen={showFilterDropdown}\n            onClick={toggleFilterDropdown}\n          >\n            {currentFilter}\n            <span className=\"arrow\">▼</span>\n          </FilterDropdownButton>\n          <FilterDropdownMenu $isOpen={showFilterDropdown}>\n            {filterOptions.map(option => (\n              <FilterDropdownItem\n                key={option}\n                $isSelected={option === currentFilter}\n                onClick={() => handleFilterChange(option)}\n              >\n                {option}\n              </FilterDropdownItem>\n            ))}\n          </FilterDropdownMenu>\n        </FilterContainer>\n        \n        <NavigationButton\n          onClick={() => handleNavigateFilter('next')}\n          disabled={currentFilterIndex === filterOptions.length - 1}\n        >\n          ›\n        </NavigationButton>\n      </Header>\n\n      <ContentArea>\n        {filteredMemos.length === 0 ? (\n          <EmptyState>\n            <div className=\"icon\">📝</div>\n            <div className=\"title\">저장된 메모가 없습니다</div>\n            <div className=\"description\">\n              훈습이나 언어화 페이지에서 메모를 생성하면 자동으로 저장됩니다\n            </div>\n          </EmptyState>\n        ) : (\n          <MemoGrid>\n            {filteredMemos.map(memo => (\n              <MemoItemWrapper key={memo.id}>\n                <MemoContent onClick={(e) => handleMemoClick(e, memo)}>\n                    <UserMemoContent>{memo.memo_content}</UserMemoContent>\n                    <SentenceContent>{memo.sentence_content}</SentenceContent>\n                </MemoContent>\n                <MemoMeta>\n                  <ThreadTypeLabel>\n                    {getPersonaName(memo)} - {getThreadTypeLabel(memo.source_thread_type)}\n                  </ThreadTypeLabel>\n                  <DateLabel>\n                    {formatDate(memo.created_at)}\n                  </DateLabel>\n                </MemoMeta>\n              </MemoItemWrapper>\n            ))}\n          </MemoGrid>\n        )}\n      </ContentArea>\n\n      {/* 컨텍스트 메뉴 */}\n      {contextMenu && (\n        <ContextMenuContainer $x={contextMenu.x} $y={contextMenu.y}>\n          <ContextMenuItem\n            onClick={() => handleContextMenuAction('interact', contextMenu.memo)}\n          >\n            상호작용 하기\n          </ContextMenuItem>\n          <ContextMenuItem\n            onClick={() => handleContextMenuAction('delete', contextMenu.memo)}\n          >\n            삭제\n          </ContextMenuItem>\n        </ContextMenuContainer>\n      )}\n\n      {/* 확인 모달 */}\n      {confirmationModal && modalContent && (\n        <ModalOverlay onClick={() => setConfirmationModal(null)}>\n          <ModalContent onClick={(e) => e.stopPropagation()}>\n            <ModalTitle>{modalContent.title}</ModalTitle>\n            <ModalMessage>{modalContent.message}</ModalMessage>\n            <ModalButtons>\n              <ModalButton \n                $variant=\"primary\" \n                onClick={handleConfirmAction}\n              >\n                {modalContent.confirmText}\n              </ModalButton>\n              <ModalButton \n                $variant=\"secondary\" \n                onClick={() => setConfirmationModal(null)}\n              >\n                {modalContent.cancelText}\n              </ModalButton>\n            </ModalButtons>\n          </ModalContent>\n        </ModalOverlay>\n      )}\n    </Container>\n  );\n};\n\nexport default MemoVaultView; "],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AAC/D,OAAOC,MAAM,MAAM,mBAAmB;AACtC,SAASC,WAAW,QAAuB,gCAAgC;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAmB5E,MAAMC,SAAS,GAAGJ,MAAM,CAACK,GAAG;AAC5B;AACA;AACA;AACA,CAAC;AAACC,EAAA,GAJIF,SAAS;AAMf,MAAMG,MAAM,GAAGP,MAAM,CAACK,GAAG;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACG,GAAA,GARID,MAAM;AAUZ,MAAME,oBAAoB,GAAGT,MAAM,CAACU,MAA4B;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiBC,KAAK,IAAIA,KAAK,CAACC,OAAO,GAAG,gBAAgB,GAAG,cAAc;AAC3E;AACA,CAAC;AAACC,GAAA,GAvBIJ,oBAAoB;AAyB1B,MAAMK,kBAAkB,GAAGd,MAAM,CAACK,GAAyB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAaM,KAAK,IAAIA,KAAK,CAACC,OAAO,GAAG,OAAO,GAAG,MAAM;AACtD;AACA;AACA,CAAC;AAACG,GAAA,GAfID,kBAAkB;AAiBxB,MAAME,kBAAkB,GAAGhB,MAAM,CAACK,GAA6B;AAC/D;AACA;AACA;AACA,gBAAgBM,KAAK,IAAIA,KAAK,CAACM,WAAW,GAAG,SAAS,GAAG,aAAa;AACtE,iBAAiBN,KAAK,IAAIA,KAAK,CAACM,WAAW,GAAG,KAAK,GAAG,QAAQ;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACC,GAAA,GAlBIF,kBAAkB;AAoBxB,MAAMG,eAAe,GAAGnB,MAAM,CAACK,GAAG;AAClC;AACA;AACA;AACA;AACA,CAAC;AAACe,GAAA,GALID,eAAe;AAOrB,MAAME,gBAAgB,GAAGrB,MAAM,CAACU,MAAM;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACY,GAAA,GArBID,gBAAgB;AAuBtB,MAAME,WAAW,GAAGvB,MAAM,CAACK,GAAG;AAC9B;AACA;AACA;AACA;AACA,CAAC;AAACmB,GAAA,GALID,WAAW;AAOjB,MAAME,QAAQ,GAAGzB,MAAM,CAACK,GAAG;AAC3B;AACA;AACA;AACA,CAAC;AAACqB,GAAA,GAJID,QAAQ;AAMd,MAAME,eAAe,GAAG3B,MAAM,CAACK,GAAG;AAClC;AACA;AACA;AACA;AACA,CAAC;AAACuB,GAAA,GALID,eAAe;AAOrB,MAAME,WAAW,GAAG7B,MAAM,CAACK,GAAG;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACyB,GAAA,GApBID,WAAW;AAsBjB,MAAME,gBAAgB,GAAG/B,MAAM,CAACK,GAAG;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAED,MAAM2B,eAAe,GAAGhC,MAAM,CAACK,GAAG;AAClC;AACA;AACA;AACA;AACA;AACA,CAAC;AAAC4B,IAAA,GANID,eAAe;AAQrB,MAAME,eAAe,GAAGlC,MAAM,CAACK,GAAG;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAAC8B,IAAA,GAbID,eAAe;AAerB,MAAME,QAAQ,GAAGpC,MAAM,CAACK,GAAG;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACgC,IAAA,GAPID,QAAQ;AASd,MAAME,eAAe,GAAGtC,MAAM,CAACuC,IAAI;AACnC;AACA;AACA;AACA;AACA;AACA,CAAC;AAACC,IAAA,GANIF,eAAe;AAQrB,MAAMG,SAAS,GAAGzC,MAAM,CAACuC,IAAI;AAC7B;AACA;AACA,CAAC;AAACG,IAAA,GAHID,SAAS;AAKf,MAAME,UAAU,GAAG3C,MAAM,CAACK,GAAG;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACuC,IAAA,GAnBID,UAAU;AAqBhB,MAAME,oBAAoB,GAAG7C,MAAM,CAACK,GAA+B;AACnE;AACA,SAASM,KAAK,IAAIA,KAAK,CAACmC,EAAE;AAC1B,UAAUnC,KAAK,IAAIA,KAAK,CAACoC,EAAE;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACC,IAAA,GAXIH,oBAAoB;AAa1B,MAAMI,eAAe,GAAGjD,MAAM,CAACK,GAAG;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAAC6C,IAAA,GAbID,eAAe;AAerB,MAAME,YAAY,GAAGnD,MAAM,CAACK,GAAG;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAAC+C,IAAA,GAXID,YAAY;AAalB,MAAME,YAAY,GAAGrD,MAAM,CAACK,GAAG;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACiD,IAAA,GAPID,YAAY;AASlB,MAAME,UAAU,GAAGvD,MAAM,CAACwD,EAAE;AAC5B;AACA;AACA;AACA;AACA,CAAC;AAACC,IAAA,GALIF,UAAU;AAOhB,MAAMG,YAAY,GAAG1D,MAAM,CAAC2D,CAAC;AAC7B;AACA;AACA;AACA;AACA,CAAC;AAACC,IAAA,GALIF,YAAY;AAOlB,MAAMG,YAAY,GAAG7D,MAAM,CAACK,GAAG;AAC/B;AACA;AACA;AACA,CAAC;AAACyD,IAAA,GAJID,YAAY;AAMlB,MAAME,WAAW,GAAG/D,MAAM,CAACU,MAA6C;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIC,KAAK,IAAIA,KAAK,CAACqD,QAAQ,KAAK,SAAS,GAAG;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,GAAG;AACN;AACA;AACA;AAC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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}