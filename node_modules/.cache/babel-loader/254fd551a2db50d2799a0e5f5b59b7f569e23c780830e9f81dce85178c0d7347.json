{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sungh\\\\Desktop\\\\chat_work\\\\frontend\\\\src\\\\features\\\\shared\\\\components\\\\ChatArea.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport Message from './Message';\nimport MessageInput from './MessageInput';\nimport TrainingCategoryView from '../../training/components/TrainingCategoryView';\nimport InterpretationView from '../../training/components/InterpretationView';\nimport ProceedView from '../../training/components/ProceedView';\nimport SentenceView from '../../training/components/SentenceView';\nimport PersonaAdminPanel from '../../admin/components/PersonaAdminPanel';\nimport LoadingMessage from './LoadingMessage';\nimport { chatApi } from '../api/chatApi';\nimport { MainArea, ChatContent, EmptyState, EmptyStateTitle, EmptyStateText } from '../styles/GlobalStyle';\nimport InteractionHistoryView from '../../training/components/InteractionHistoryView';\nimport RecentInteractionsView from '../components/RecentInteractionsView';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ChatArea = ({\n  selectedConversation,\n  conversations,\n  personas,\n  globalMessages,\n  isLoading,\n  error,\n  onSendInitialMessage,\n  onContinueConversation,\n  onClearError,\n  selectedPersonaItem,\n  onSelectPersona,\n  onInterpretationComplete,\n  selectedConversationItem,\n  currentInterpretation,\n  onInterpretationMessage,\n  onUpdateInterpretation,\n  onUpdateConversation,\n  onSwitchConversationMode,\n  onRefreshConversationSidebar,\n  recentInteractionsProps,\n  verbalizationProps\n}) => {\n  _s();\n  var _personas$currentConv, _personas$currentConv2, _personas$currentConv3;\n  const chatContentRef = useRef(null);\n  const currentConversation = selectedConversation ? conversations[selectedConversation] : null;\n\n  // í¸ì§‘ ìƒíƒœ ê´€ë¦¬\n  const [editingMessageIndex, setEditingMessageIndex] = useState(null);\n\n  // í›ˆìŠµ ê´€ë ¨ ìƒíƒœ\n  const [threads, setThreads] = useState([]);\n  const [proceedContent, setProceedContent] = useState('');\n  const [sentenceContent, setSentenceContent] = useState('');\n  const [interactionRecords, setInteractionRecords] = useState([]);\n\n  // ë©”ì‹œì§€ê°€ ì¶”ê°€ë  ë•Œë§ˆë‹¤ ìŠ¤í¬ë¡¤ì„ ë§¨ ì•„ë˜ë¡œ\n  useEffect(() => {\n    if (chatContentRef.current) {\n      chatContentRef.current.scrollTop = chatContentRef.current.scrollHeight;\n    }\n  }, [currentConversation === null || currentConversation === void 0 ? void 0 : currentConversation.messages, globalMessages, isLoading]);\n\n  // í›ˆìŠµ ë°ì´í„° ë¡œë”©ì„ ë” ì •í™•í•˜ê²Œ ìˆ˜ì •\n  useEffect(() => {\n    const loadTrainingData = async () => {\n      if (!(currentInterpretation !== null && currentInterpretation !== void 0 && currentInterpretation.personaId)) return;\n      try {\n        // ìŠ¤ë ˆë“œ ë°ì´í„° ë¡œë“œ\n        const threadsResponse = await chatApi.getPersonaThreads(currentInterpretation.personaId);\n        if (threadsResponse.data) {\n          setThreads(threadsResponse.data);\n\n          // ë‚˜ì•„ê°€ê¸°ì™€ ë¬¸ì¥ ìŠ¤ë ˆë“œì—ì„œ ì½˜í…ì¸  ì¶”ì¶œ\n          const proceedThread = threadsResponse.data.find(t => t.thread_type === 'proceed');\n          const sentenceThread = threadsResponse.data.find(t => t.thread_type === 'sentence');\n          if (proceedThread && proceedThread.messages.length > 0) {\n            const firstProceedMessage = proceedThread.messages.find(m => m.role === 'assistant');\n            if (firstProceedMessage) {\n              setProceedContent(firstProceedMessage.content);\n            }\n          }\n          if (sentenceThread && sentenceThread.messages.length > 0) {\n            const firstSentenceMessage = sentenceThread.messages.find(m => m.role === 'assistant');\n            if (firstSentenceMessage) {\n              setSentenceContent(firstSentenceMessage.content);\n            }\n          }\n        }\n      } catch (error) {\n        console.error('í›ˆìŠµ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);\n      }\n    };\n    loadTrainingData();\n  }, [currentInterpretation === null || currentInterpretation === void 0 ? void 0 : currentInterpretation.personaId]);\n\n  // ìŠ¤ë ˆë“œ ì—…ë°ì´íŠ¸ ì‹œ ì½˜í…ì¸ ë„ ì—…ë°ì´íŠ¸\n  useEffect(() => {\n    const proceedThread = threads.find(t => t.thread_type === 'proceed');\n    const sentenceThread = threads.find(t => t.thread_type === 'sentence');\n    if (proceedThread && proceedThread.messages.length > 0) {\n      const firstProceedMessage = proceedThread.messages.find(m => m.role === 'assistant');\n      if (firstProceedMessage) {\n        setProceedContent(firstProceedMessage.content);\n      }\n    }\n    if (sentenceThread && sentenceThread.messages.length > 0) {\n      const firstSentenceMessage = sentenceThread.messages.find(m => m.role === 'assistant');\n      if (firstSentenceMessage) {\n        setSentenceContent(firstSentenceMessage.content);\n      }\n    }\n  }, [threads]);\n\n  // ìƒí˜¸ì‘ìš© ê¸°ë¡ ë¡œë“œ\n  useEffect(() => {\n    const loadInteractionRecords = async () => {\n      try {\n        const recordsResponse = await chatApi.getAllInteractionRecords();\n        if (recordsResponse.data) {\n          setInteractionRecords(recordsResponse.data);\n        }\n      } catch (error) {\n        console.error('ìƒí˜¸ì‘ìš© ê¸°ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);\n      }\n    };\n    loadInteractionRecords();\n  }, [currentInterpretation, threads]); // threadsë‚˜ currentInterpretationì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ ìƒˆë¡œê³ ì¹¨\n\n  const handleSendMessage = async message => {\n    if (selectedConversation) {\n      // ê¸°ì¡´ ëŒ€í™”ì— ë©”ì‹œì§€ ì¶”ê°€\n      return await onContinueConversation(selectedConversation, message);\n    } else if (currentInterpretation) {\n      // í•´ì„ ëª¨ë“œì—ì„œëŠ” í•´ì„ ê´€ë ¨ ë©”ì‹œì§€ ì „ì†¡\n      return await onInterpretationMessage(message);\n    } else {\n      // ìƒˆë¡œìš´ ëŒ€í™” ì‹œì‘\n      return await onSendInitialMessage(message);\n    }\n  };\n\n  // í•´ì„ ë©”ì‹œì§€ ìˆ˜ì • í•¸ë“¤ëŸ¬\n  const handleEditInterpretationMessage = async (messageIndex, newContent) => {\n    if (!currentInterpretation) return false;\n    try {\n      // ë©”ì‹œì§€ ìˆ˜ì • - ìˆ˜ì • í›„ ìƒˆë¡œìš´ ì‘ë‹µ ìë™ ìƒì„±\n      const updatedMessages = [...currentInterpretation.messages];\n      if (messageIndex >= 0 && messageIndex < updatedMessages.length) {\n        // ìˆ˜ì •ëœ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸\n        updatedMessages[messageIndex] = {\n          ...updatedMessages[messageIndex],\n          content: newContent,\n          timestamp: new Date().toISOString()\n        };\n\n        // ìˆ˜ì •ëœ ë©”ì‹œì§€ ì´í›„ì˜ ëª¨ë“  ë©”ì‹œì§€ë“¤ ì œê±°\n        const filteredMessages = updatedMessages.slice(0, messageIndex + 1);\n\n        // ë°±ì—”ë“œ APIë¥¼ í†µí•´ ìƒˆë¡œìš´ AI ì‘ë‹µ ìƒì„±\n        try {\n          const response = await chatApi.chatWithInterpretation(currentInterpretation.personaId, newContent);\n          if (response.data) {\n            const aiResponse = {\n              role: 'assistant',\n              content: response.data.response,\n              timestamp: response.data.timestamp\n            };\n            const updatedInterpretation = {\n              ...currentInterpretation,\n              messages: [...filteredMessages, aiResponse]\n            };\n\n            // ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì— ì—…ë°ì´íŠ¸ ì•Œë¦¼\n            if (onUpdateInterpretation) {\n              onUpdateInterpretation(updatedInterpretation);\n            }\n            return true;\n          } else {\n            // API í˜¸ì¶œ ì‹¤íŒ¨ ì‹œ ë¡œì»¬ì—ì„œ ì„ì‹œ ì‘ë‹µ ìƒì„±\n            const aiResponse = {\n              role: 'assistant',\n              content: `${currentInterpretation.personaName}ì˜ ê´€ì ì—ì„œ ìˆ˜ì •ëœ ë©”ì‹œì§€ì— ëŒ€í•´ ìƒˆë¡­ê²Œ ì‘ë‹µë“œë¦¬ê² ìŠµë‹ˆë‹¤.\\n\\n\"${newContent}\"ì— ëŒ€í•´ ë¶„ì„í•´ë³´ë©´, ì´ëŠ” ì´ì „ê³¼ëŠ” ë‹¤ë¥¸ ë§¥ë½ì„ ì œì‹œí•˜ê³  ìˆìŠµë‹ˆë‹¤. ìˆ˜ì •ëœ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ìƒˆë¡œìš´ í•´ì„ê³¼ í†µì°°ì„ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤.`,\n              timestamp: new Date().toISOString()\n            };\n            const updatedInterpretation = {\n              ...currentInterpretation,\n              messages: [...filteredMessages, aiResponse]\n            };\n            if (onUpdateInterpretation) {\n              onUpdateInterpretation(updatedInterpretation);\n            }\n            return true;\n          }\n        } catch (apiError) {\n          console.error('í•´ì„ API í˜¸ì¶œ ì‹¤íŒ¨:', apiError);\n\n          // API í˜¸ì¶œ ì‹¤íŒ¨ ì‹œ ë¡œì»¬ì—ì„œ ì„ì‹œ ì‘ë‹µ ìƒì„±\n          const aiResponse = {\n            role: 'assistant',\n            content: `${currentInterpretation.personaName}ì˜ ê´€ì ì—ì„œ ìˆ˜ì •ëœ ë©”ì‹œì§€ì— ëŒ€í•´ ìƒˆë¡­ê²Œ ì‘ë‹µë“œë¦¬ê² ìŠµë‹ˆë‹¤.\\n\\n\"${newContent}\"ì— ëŒ€í•´ ë¶„ì„í•´ë³´ë©´, ì´ëŠ” ì´ì „ê³¼ëŠ” ë‹¤ë¥¸ ë§¥ë½ì„ ì œì‹œí•˜ê³  ìˆìŠµë‹ˆë‹¤. ìˆ˜ì •ëœ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ìƒˆë¡œìš´ í•´ì„ê³¼ í†µì°°ì„ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤.`,\n            timestamp: new Date().toISOString()\n          };\n          const updatedInterpretation = {\n            ...currentInterpretation,\n            messages: [...filteredMessages, aiResponse]\n          };\n          if (onUpdateInterpretation) {\n            onUpdateInterpretation(updatedInterpretation);\n          }\n          return true;\n        }\n      }\n      return false;\n    } catch (error) {\n      console.error('í•´ì„ ë©”ì‹œì§€ ìˆ˜ì • ì‹¤íŒ¨:', error);\n      return false;\n    }\n  };\n\n  // ì¼ë°˜ ëŒ€í™” ë©”ì‹œì§€ ìˆ˜ì • í•¸ë“¤ëŸ¬\n  const handleEditConversationMessage = async (messageIndex, newContent) => {\n    if (!selectedConversation || !currentConversation) return false;\n    try {\n      var _result$data;\n      const result = await chatApi.editMessage(selectedConversation, messageIndex, newContent);\n      if ((_result$data = result.data) !== null && _result$data !== void 0 && _result$data.success && result.data.updated_conversation) {\n        // ìˆ˜ì •ëœ ëŒ€í™” ì •ë³´ë¡œ ì¦‰ì‹œ UI ì—…ë°ì´íŠ¸\n        if (onUpdateConversation) {\n          onUpdateConversation(result.data.updated_conversation);\n        }\n        return true;\n      } else {\n        console.error('ë©”ì‹œì§€ ìˆ˜ì • ì‹¤íŒ¨:', result.error);\n        return false;\n      }\n    } catch (error) {\n      console.error('ë©”ì‹œì§€ ìˆ˜ì • ìš”ì²­ ì‹¤íŒ¨:', error);\n      return false;\n    }\n  };\n  const getHeaderTitle = () => {\n    if (selectedConversation && currentConversation) {\n      const persona = personas[currentConversation.persona_id];\n      return `${persona === null || persona === void 0 ? void 0 : persona.name}ê³¼ì˜ ëŒ€í™”`;\n    }\n    return 'ë‹¤ì¤‘ í˜ë¥´ì†Œë‚˜ ì±„íŒ…';\n  };\n  const getHeaderSubtitle = () => {\n    if (selectedConversation && currentConversation) {\n      return `${currentConversation.messages.length}ê°œì˜ ë©”ì‹œì§€`;\n    }\n    return 'ëª¨ë“  í˜ë¥´ì†Œë‚˜ì™€ ëŒ€í™”í•˜ê±°ë‚˜ ê°œë³„ í˜ë¥´ì†Œë‚˜ë¥¼ ì„ íƒí•˜ì„¸ìš”';\n  };\n  const renderInitialResponses = () => {\n    if (!globalMessages.length) return null;\n    const latestMessage = globalMessages[globalMessages.length - 1];\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Message, {\n        message: {\n          role: 'user',\n          content: latestMessage.user_message,\n          timestamp: latestMessage.timestamp\n        },\n        personas: personas,\n        showActionButtons: false\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 9\n      }, this), latestMessage.responses.map(response => /*#__PURE__*/_jsxDEV(Message, {\n        message: {\n          role: 'assistant',\n          content: response.content,\n          timestamp: response.timestamp,\n          persona_id: response.persona_id,\n          persona_name: response.persona_name\n        },\n        personas: personas,\n        showActionButtons: true\n      }, `${latestMessage.id}_${response.persona_id}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          margin: '20px 0',\n          padding: '16px',\n          backgroundColor: '#f8f8f8',\n          borderRadius: '8px',\n          border: 'none',\n          textAlign: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '14px',\n            color: '#666',\n            marginBottom: '8px'\n          },\n          children: \"\\uD83D\\uDCA1 \\uAC01 \\uD398\\uB974\\uC18C\\uB098\\uC640 \\uAC1C\\uBCC4\\uC801\\uC73C\\uB85C \\uB300\\uD654\\uB97C \\uC774\\uC5B4\\uAC00\\uB824\\uBA74\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 378,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '13px',\n            color: '#888'\n          },\n          children: \"\\uC67C\\uCABD \\uC0AC\\uC774\\uB4DC\\uBC14\\uC5D0\\uC11C \\uD398\\uB974\\uC18C\\uB098\\uB97C \\uC120\\uD0DD\\uD558\\uAC70\\uB098, \\uD2B9\\uC815 \\uB300\\uD654\\uB97C \\uC120\\uD0DD\\uD558\\uC138\\uC694\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 370,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 7\n    }, this);\n  };\n  const renderConversation = () => {\n    if (!currentConversation) return null;\n    return currentConversation.messages.map((message, index) => /*#__PURE__*/_jsxDEV(Message, {\n      message: message,\n      personas: personas,\n      showActionButtons: true,\n      onCopy: () => {\n        navigator.clipboard.writeText(message.content);\n      },\n      onEdit: message.role === 'user' ? () => setEditingMessageIndex(index) : undefined,\n      onEditSave: message.role === 'user' ? async newContent => {\n        const success = await handleEditConversationMessage(index, newContent);\n        if (success) {\n          setEditingMessageIndex(null);\n        }\n        return success;\n      } : undefined,\n      onEditCancel: () => setEditingMessageIndex(null),\n      isEditing: editingMessageIndex === index,\n      onSunAction: () => {},\n      onPersonAction: () => {},\n      onDocumentAction: () => {}\n    }, `${currentConversation.id}_${index}`, false, {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 7\n    }, this));\n  };\n  const renderEmptyState = () => /*#__PURE__*/_jsxDEV(EmptyState, {\n    children: [/*#__PURE__*/_jsxDEV(EmptyStateTitle, {\n      children: \"\\uC0C8\\uB85C\\uC6B4 \\uB300\\uD654\\uB97C \\uC2DC\\uC791\\uD574\\uBCF4\\uC138\\uC694!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(EmptyStateText, {\n      children: Object.keys(personas).length > 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [\"\\uC544\\uB798\\uC5D0 \\uC9C8\\uBB38\\uC744 \\uC785\\uB825\\uD558\\uBA74 \", Object.keys(personas).length, \"\\uAC1C\\uC758 \\uD398\\uB974\\uC18C\\uB098\\uAC00\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 64\n        }, this), \"\\uAC01\\uAC01 \\uB2E4\\uB978 \\uAD00\\uC810\\uC5D0\\uC11C \\uB2F5\\uBCC0\\uD574\\uB4DC\\uB9BD\\uB2C8\\uB2E4.\"]\n      }, void 0, true) : 'í˜ë¥´ì†Œë‚˜ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 421,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 419,\n    columnNumber: 5\n  }, this);\n\n  // ëª¨ë“œ ì „í™˜ í•¸ë“¤ëŸ¬\n  const handleSwitchToMode = mode => {\n    if (onSwitchConversationMode) {\n      onSwitchConversationMode(mode);\n    }\n  };\n\n  // ìƒˆë¡œìš´ í•´ì„ ìƒì„± í•¸ë“¤ëŸ¬\n  const handleGenerateNewInterpretation = async () => {\n    if (!(currentInterpretation !== null && currentInterpretation !== void 0 && currentInterpretation.personaId)) return;\n    try {\n      // ìƒˆë¡œìš´ í•´ì„ì„ ìƒì„±í•˜ê³  ì™„ë£Œ ì½œë°± í˜¸ì¶œ\n      onInterpretationComplete(currentInterpretation.personaId, 'ìƒˆë¡œìš´ í•´ì„ì„ ìƒì„±í•©ë‹ˆë‹¤...');\n    } catch (error) {\n      console.error('ìƒˆë¡œìš´ í•´ì„ ìƒì„± ì‹¤íŒ¨:', error);\n    }\n  };\n\n  // ì„ íƒëœ ìŠ¤ë ˆë“œ ì¶”ì¶œ\n  const getSelectedThread = conversationItem => {\n    if (!conversationItem || !conversationItem.includes('-thread-')) return null;\n    const threadId = conversationItem.split('-thread-')[1];\n    return threads.find(thread => thread.id === threadId) || null;\n  };\n\n  // ìŠ¤ë ˆë“œ ìƒˆë¡œê³ ì¹¨ í•¨ìˆ˜\n  const handleRefreshThreads = async () => {\n    if (!(currentInterpretation !== null && currentInterpretation !== void 0 && currentInterpretation.personaId)) return;\n    try {\n      const threadsResponse = await chatApi.getPersonaThreads(currentInterpretation.personaId);\n      if (threadsResponse.data) {\n        const updatedThreads = threadsResponse.data;\n        setThreads(updatedThreads);\n\n        // ì½˜í…ì¸  ì—…ë°ì´íŠ¸\n        const proceedThread = updatedThreads.find(t => t.thread_type === 'proceed');\n        const sentenceThread = updatedThreads.find(t => t.thread_type === 'sentence');\n        if (proceedThread && proceedThread.messages.length > 0) {\n          const firstProceedMessage = proceedThread.messages.find(m => m.role === 'assistant');\n          if (firstProceedMessage) {\n            setProceedContent(firstProceedMessage.content);\n          }\n        }\n        if (sentenceThread && sentenceThread.messages.length > 0) {\n          const firstSentenceMessage = sentenceThread.messages.find(m => m.role === 'assistant');\n          if (firstSentenceMessage) {\n            setSentenceContent(firstSentenceMessage.content);\n          }\n        }\n\n        // ConversationSidebar ìƒˆë¡œê³ ì¹¨\n        if (onRefreshConversationSidebar) {\n          onRefreshConversationSidebar();\n        }\n      }\n    } catch (error) {\n      console.error('ìŠ¤ë ˆë“œ ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨:', error);\n    }\n  };\n\n  // í•´ì„ ë·° ë Œë”ë§\n  const renderInterpretationView = () => {\n    if (!currentInterpretation) return null;\n    return /*#__PURE__*/_jsxDEV(InterpretationView, {\n      interpretation: currentInterpretation.content,\n      personaName: currentInterpretation.personaName,\n      onSendMessage: onInterpretationMessage,\n      onEditMessage: handleEditInterpretationMessage,\n      isLoading: isLoading,\n      messages: currentInterpretation.messages,\n      onGenerateNewInterpretation: handleGenerateNewInterpretation,\n      onSwitchToMode: handleSwitchToMode,\n      personaId: currentInterpretation.personaId,\n      onRefreshThreads: handleRefreshThreads\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 504,\n      columnNumber: 7\n    }, this);\n  };\n\n  // ë‚˜ì•„ê°€ê¸° ë·° ë Œë”ë§\n  const renderProceedView = () => {\n    if (!currentInterpretation) return null;\n    const selectedThread = getSelectedThread(selectedConversationItem);\n    return /*#__PURE__*/_jsxDEV(ProceedView, {\n      personaId: currentInterpretation.personaId,\n      personaName: currentInterpretation.personaName,\n      proceedContent: proceedContent || 'ë‚˜ì•„ê°€ê¸°ë¥¼ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...',\n      threads: threads,\n      onThreadUpdate: updatedThreads => {\n        setThreads(updatedThreads);\n        // ìŠ¤ë ˆë“œ ì—…ë°ì´íŠ¸ ì‹œ ì½˜í…ì¸ ë„ ì—…ë°ì´íŠ¸\n        const proceedThread = updatedThreads.find(t => t.thread_type === 'proceed');\n        if (proceedThread && proceedThread.messages.length > 0) {\n          const firstProceedMessage = proceedThread.messages.find(m => m.role === 'assistant');\n          if (firstProceedMessage) {\n            setProceedContent(firstProceedMessage.content);\n          }\n        }\n        // ConversationSidebar ìƒˆë¡œê³ ì¹¨\n        if (onRefreshConversationSidebar) {\n          onRefreshConversationSidebar();\n        }\n      },\n      onSwitchToMode: handleSwitchToMode,\n      onGenerateNewInterpretation: handleGenerateNewInterpretation,\n      selectedThread: selectedThread\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 526,\n      columnNumber: 7\n    }, this);\n  };\n\n  // ë¬¸ì¥ ë·° ë Œë”ë§\n  const renderSentenceView = () => {\n    if (!currentInterpretation) return null;\n    const selectedThread = getSelectedThread(selectedConversationItem);\n    return /*#__PURE__*/_jsxDEV(SentenceView, {\n      personaId: currentInterpretation.personaId,\n      personaName: currentInterpretation.personaName,\n      sentenceContent: sentenceContent || 'ë¬¸ì¥ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...',\n      threads: threads,\n      onThreadUpdate: updatedThreads => {\n        setThreads(updatedThreads);\n        // ìŠ¤ë ˆë“œ ì—…ë°ì´íŠ¸ ì‹œ ì½˜í…ì¸ ë„ ì—…ë°ì´íŠ¸\n        const sentenceThread = updatedThreads.find(t => t.thread_type === 'sentence');\n        if (sentenceThread && sentenceThread.messages.length > 0) {\n          const firstSentenceMessage = sentenceThread.messages.find(m => m.role === 'assistant');\n          if (firstSentenceMessage) {\n            setSentenceContent(firstSentenceMessage.content);\n          }\n        }\n        // ConversationSidebar ìƒˆë¡œê³ ì¹¨\n        if (onRefreshConversationSidebar) {\n          onRefreshConversationSidebar();\n        }\n      },\n      onSwitchToMode: handleSwitchToMode,\n      onGenerateNewInterpretation: handleGenerateNewInterpretation,\n      selectedThread: selectedThread\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 560,\n      columnNumber: 7\n    }, this);\n  };\n\n  // ìƒí˜¸ì‘ìš© ê¸°ë¡ ë·° ë Œë”ë§\n  const renderInteractionHistoryView = () => {\n    if (!currentInterpretation) return null;\n    return /*#__PURE__*/_jsxDEV(InteractionHistoryView, {\n      personaId: currentInterpretation.personaId,\n      personaName: currentInterpretation.personaName,\n      allInteractionRecords: interactionRecords,\n      onThreadSelect: handleInteractionThreadSelect,\n      onSwitchToMode: handleSwitchToMode,\n      onGenerateNewInterpretation: handleGenerateNewInterpretation\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 592,\n      columnNumber: 7\n    }, this);\n  };\n\n  // ìƒí˜¸ì‘ìš© ê¸°ë¡ì—ì„œ ìŠ¤ë ˆë“œ ì„ íƒ í•¸ë“¤ëŸ¬\n  const handleInteractionThreadSelect = thread => {\n    // í•´ë‹¹ ìŠ¤ë ˆë“œì˜ ëª¨ë“œë¡œ ì „í™˜í•˜ê³  ìŠ¤ë ˆë“œ ì„ íƒ\n    if (onSwitchConversationMode) {\n      onSwitchConversationMode(`${thread.thread_type}-thread-${thread.id}`);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(MainArea, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        height: '80px',\n        borderBottom: '1px solid #ddd',\n        background: 'white'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 614,\n      columnNumber: 11\n    }, this), selectedPersonaItem === 'training' ? /*#__PURE__*/_jsxDEV(TrainingCategoryView, {\n      personas: personas,\n      onSelectPersona: onSelectPersona || (() => {}),\n      onInterpretationComplete: onInterpretationComplete\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 624,\n      columnNumber: 9\n    }, this) : selectedPersonaItem === 'recent' ?\n    /*#__PURE__*/\n    // ìµœê·¼ ìƒí˜¸ì‘ìš© ëª¨ë“œì¼ ë•Œ RecentInteractionsView í‘œì‹œ\n    _jsxDEV(RecentInteractionsView, {\n      personas: (recentInteractionsProps === null || recentInteractionsProps === void 0 ? void 0 : recentInteractionsProps.personas) || {},\n      onSelectPersona: (recentInteractionsProps === null || recentInteractionsProps === void 0 ? void 0 : recentInteractionsProps.onSelectPersona) || (() => {}),\n      onThreadSelect: (recentInteractionsProps === null || recentInteractionsProps === void 0 ? void 0 : recentInteractionsProps.onThreadSelect) || (() => {}),\n      selectedThreadId: selectedConversationItem !== null && selectedConversationItem !== void 0 && selectedConversationItem.startsWith('recent-thread-') ? selectedConversationItem.split('-')[2] : undefined,\n      selectedPersonaId: selectedConversationItem !== null && selectedConversationItem !== void 0 && selectedConversationItem.startsWith('recent-thread-') ? selectedConversationItem.split('-')[3] : undefined\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 631,\n      columnNumber: 9\n    }, this) : selectedPersonaItem === 'admin' ? /*#__PURE__*/_jsxDEV(PersonaAdminPanel, {\n      onClose: () => {\n        // ê´€ë¦¬ ëª¨ë“œ ì¢…ë£Œ ì‹œ PersonaSidebarë¡œ ëŒì•„ê°€ê¸°\n        if (onSelectPersona) {\n          onSelectPersona(''); // ë¹ˆ ê°’ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ PersonaSidebarì˜ selectedItemì„ nullë¡œ ë§Œë“¦\n        }\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 647,\n      columnNumber: 9\n    }, this) : currentInterpretation && (selectedConversationItem === 'proceed' || selectedConversationItem !== null && selectedConversationItem !== void 0 && selectedConversationItem.startsWith('proceed-thread-')) ?\n    // ë‚˜ì•„ê°€ê¸° ëª¨ë“œì¼ ë•Œ ProceedView ì‚¬ìš©\n    renderProceedView() : currentInterpretation && (selectedConversationItem === 'sentence' || selectedConversationItem !== null && selectedConversationItem !== void 0 && selectedConversationItem.startsWith('sentence-thread-')) ?\n    // ë¬¸ì¥ ëª¨ë“œì¼ ë•Œ SentenceView ì‚¬ìš©\n    renderSentenceView() : currentInterpretation && (selectedConversationItem === 'interpretation' || selectedConversationItem !== null && selectedConversationItem !== void 0 && selectedConversationItem.startsWith('interpretation-thread-')) ?\n    // í•´ì„ ëª¨ë“œì¼ ë•Œ InterpretationView ì‚¬ìš©\n    renderInterpretationView() : currentInterpretation && selectedConversationItem === 'interaction_history' ?\n    // ìƒí˜¸ì‘ìš© ê¸°ë¡ ëª¨ë“œì¼ ë•Œ InteractionHistoryView ì‚¬ìš©\n    renderInteractionHistoryView() : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(ChatContent, {\n        ref: chatContentRef,\n        children: [!selectedConversation && !currentInterpretation && globalMessages.length === 0 && renderEmptyState(), !selectedConversation && !currentInterpretation && globalMessages.length > 0 && renderInitialResponses(), selectedConversation && renderConversation(), isLoading && (selectedConversation && currentConversation ? /*#__PURE__*/_jsxDEV(LoadingMessage, {\n          personaName: (_personas$currentConv = personas[currentConversation.persona_id]) === null || _personas$currentConv === void 0 ? void 0 : _personas$currentConv.name,\n          personaColor: (_personas$currentConv2 = personas[currentConversation.persona_id]) === null || _personas$currentConv2 === void 0 ? void 0 : _personas$currentConv2.color\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 682,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(LoadingMessage, {\n          personaName: \"AI\",\n          personaColor: \"#666\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 687,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 669,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(MessageInput, {\n        onSendMessage: handleSendMessage,\n        disabled: isLoading || Object.keys(personas).length === 0,\n        placeholder: selectedConversation && currentConversation ? `${(_personas$currentConv3 = personas[currentConversation.persona_id]) === null || _personas$currentConv3 === void 0 ? void 0 : _personas$currentConv3.name}ì—ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ì„¸ìš”...` : \"ëª¨ë“  í˜ë¥´ì†Œë‚˜ì—ê²Œ ì§ˆë¬¸í•´ë³´ì„¸ìš”...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 695,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 612,\n    columnNumber: 5\n  }, this);\n};\n_s(ChatArea, \"ZpaVkbWLJKttFKo6G/JtUbnr7cQ=\");\n_c = ChatArea;\nexport default ChatArea;\nvar _c;\n$RefreshReg$(_c, \"ChatArea\");","map":{"version":3,"names":["React","useEffect","useRef","useState","Message","MessageInput","TrainingCategoryView","InterpretationView","ProceedView","SentenceView","PersonaAdminPanel","LoadingMessage","chatApi","MainArea","ChatContent","EmptyState","EmptyStateTitle","EmptyStateText","InteractionHistoryView","RecentInteractionsView","jsxDEV","_jsxDEV","Fragment","_Fragment","ChatArea","selectedConversation","conversations","personas","globalMessages","isLoading","error","onSendInitialMessage","onContinueConversation","onClearError","selectedPersonaItem","onSelectPersona","onInterpretationComplete","selectedConversationItem","currentInterpretation","onInterpretationMessage","onUpdateInterpretation","onUpdateConversation","onSwitchConversationMode","onRefreshConversationSidebar","recentInteractionsProps","verbalizationProps","_s","_personas$currentConv","_personas$currentConv2","_personas$currentConv3","chatContentRef","currentConversation","editingMessageIndex","setEditingMessageIndex","threads","setThreads","proceedContent","setProceedContent","sentenceContent","setSentenceContent","interactionRecords","setInteractionRecords","current","scrollTop","scrollHeight","messages","loadTrainingData","personaId","threadsResponse","getPersonaThreads","data","proceedThread","find","t","thread_type","sentenceThread","length","firstProceedMessage","m","role","content","firstSentenceMessage","console","loadInteractionRecords","recordsResponse","getAllInteractionRecords","handleSendMessage","message","handleEditInterpretationMessage","messageIndex","newContent","updatedMessages","timestamp","Date","toISOString","filteredMessages","slice","response","chatWithInterpretation","aiResponse","updatedInterpretation","personaName","apiError","handleEditConversationMessage","_result$data","result","editMessage","success","updated_conversation","getHeaderTitle","persona","persona_id","name","getHeaderSubtitle","renderInitialResponses","latestMessage","children","user_message","showActionButtons","fileName","_jsxFileName","lineNumber","columnNumber","responses","map","persona_name","id","style","margin","padding","backgroundColor","borderRadius","border","textAlign","fontSize","color","marginBottom","renderConversation","index","onCopy","navigator","clipboard","writeText","onEdit","undefined","onEditSave","onEditCancel","isEditing","onSunAction","onPersonAction","onDocumentAction","renderEmptyState","Object","keys","handleSwitchToMode","mode","handleGenerateNewInterpretation","getSelectedThread","conversationItem","includes","threadId","split","thread","handleRefreshThreads","updatedThreads","renderInterpretationView","interpretation","onSendMessage","onEditMessage","onGenerateNewInterpretation","onSwitchToMode","onRefreshThreads","renderProceedView","selectedThread","onThreadUpdate","renderSentenceView","renderInteractionHistoryView","allInteractionRecords","onThreadSelect","handleInteractionThreadSelect","height","borderBottom","background","selectedThreadId","startsWith","selectedPersonaId","onClose","ref","personaColor","disabled","placeholder","_c","$RefreshReg$"],"sources":["C:/Users/sungh/Desktop/chat_work/frontend/src/features/shared/components/ChatArea.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { Conversation, Persona, GlobalMessage, TrainingThread, InteractionRecord } from '../types';\nimport Message from './Message';\nimport MessageInput from './MessageInput';\nimport TrainingCategoryView from '../../training/components/TrainingCategoryView';\nimport InterpretationView from '../../training/components/InterpretationView';\nimport ProceedView from '../../training/components/ProceedView';\nimport SentenceView from '../../training/components/SentenceView';\nimport PersonaAdminPanel from '../../admin/components/PersonaAdminPanel';\nimport LoadingMessage from './LoadingMessage';\nimport { chatApi } from '../api/chatApi';\nimport {\n  MainArea,\n  ChatHeader,\n  ChatHeaderTitle,\n  ChatContent,\n  LoadingSpinner,\n  ErrorMessage,\n  EmptyState,\n  EmptyStateTitle,\n  EmptyStateText,\n} from '../styles/GlobalStyle';\nimport InteractionHistoryView from '../../training/components/InteractionHistoryView';\nimport RecentInteractionsView from '../components/RecentInteractionsView';\nimport VerbalizationView from '../../verbalization/components/VerbalizationView';\n\ninterface ChatAreaProps {\n  selectedConversation: string | null;\n  conversations: Record<string, Conversation>;\n  personas: Record<string, Persona>;\n  globalMessages: GlobalMessage[];\n  isLoading: boolean;\n  error: string | null;\n  onSendInitialMessage: (message: string) => Promise<boolean>;\n  onContinueConversation: (conversationId: string, message: string) => Promise<boolean>;\n  onClearError: () => void;\n  selectedPersonaItem?: string | null; // í›ˆìŠµ ëª¨ë“œ í™•ì¸ìš©\n  onSelectPersona?: (personaId: string) => void; // í˜ë¥´ì†Œë‚˜ ì„ íƒ í•¸ë“¤ëŸ¬\n  onInterpretationComplete: (personaId: string, interpretation: string) => void; // í•´ì„ ì™„ë£Œ í•¸ë“¤ëŸ¬\n  selectedConversationItem?: string | null; // ì„ íƒëœ ëŒ€í™” í•­ëª©\n  currentInterpretation?: {\n    personaId: string;\n    personaName: string;\n    content: string;\n    messages: Array<{\n      role: 'user' | 'assistant';\n      content: string;\n      timestamp: string;\n    }>;\n  } | null;\n  onInterpretationMessage: (message: string) => Promise<boolean>; // í•´ì„ ì±„íŒ… ë©”ì‹œì§€ í•¸ë“¤ëŸ¬\n  onUpdateInterpretation?: (updatedInterpretation: {\n    personaId: string;\n    personaName: string;\n    content: string;\n    messages: Array<{\n      role: 'user' | 'assistant';\n      content: string;\n      timestamp: string;\n    }>;\n  }) => void; // í•´ì„ ì—…ë°ì´íŠ¸ í•¸ë“¤ëŸ¬\n  onUpdateConversation?: (updatedConversation: any) => void; // ëŒ€í™” ì—…ë°ì´íŠ¸ í•¸ë“¤ëŸ¬\n  onSwitchConversationMode?: (mode: string) => void; // ëŒ€í™” ëª¨ë“œ ì „í™˜ í•¸ë“¤ëŸ¬\n  onRefreshConversationSidebar?: () => void; // ConversationSidebar ìƒˆë¡œê³ ì¹¨ í•¸ë“¤ëŸ¬\n  recentInteractionsProps?: {\n    personas: Record<string, Persona>;\n    onSelectPersona: (personaId: string) => void;\n    onThreadSelect: (thread: TrainingThread, personaId: string) => void;\n  }; // ìµœê·¼ ìƒí˜¸ì‘ìš© ê´€ë ¨ props\n  verbalizationProps?: {\n    selectedThread: TrainingThread | null;\n    threads: TrainingThread[];\n    onThreadUpdate: () => void;\n    onCreateNewThread: () => void;\n  }; // ì–¸ì–´í™” ê´€ë ¨ props\n}\n\nconst ChatArea: React.FC<ChatAreaProps> = ({\n  selectedConversation,\n  conversations,\n  personas,\n  globalMessages,\n  isLoading,\n  error,\n  onSendInitialMessage,\n  onContinueConversation,\n  onClearError,\n  selectedPersonaItem,\n  onSelectPersona,\n  onInterpretationComplete,\n  selectedConversationItem,\n  currentInterpretation,\n  onInterpretationMessage,\n  onUpdateInterpretation,\n  onUpdateConversation,\n  onSwitchConversationMode,\n  onRefreshConversationSidebar,\n  recentInteractionsProps,\n  verbalizationProps,\n}) => {\n  const chatContentRef = useRef<HTMLDivElement>(null);\n  const currentConversation = selectedConversation ? conversations[selectedConversation] : null;\n  \n  // í¸ì§‘ ìƒíƒœ ê´€ë¦¬\n  const [editingMessageIndex, setEditingMessageIndex] = useState<number | null>(null);\n  \n  // í›ˆìŠµ ê´€ë ¨ ìƒíƒœ\n  const [threads, setThreads] = useState<TrainingThread[]>([]);\n  const [proceedContent, setProceedContent] = useState<string>('');\n  const [sentenceContent, setSentenceContent] = useState<string>('');\n  const [interactionRecords, setInteractionRecords] = useState<InteractionRecord[]>([]);\n\n  // ë©”ì‹œì§€ê°€ ì¶”ê°€ë  ë•Œë§ˆë‹¤ ìŠ¤í¬ë¡¤ì„ ë§¨ ì•„ë˜ë¡œ\n  useEffect(() => {\n    if (chatContentRef.current) {\n      chatContentRef.current.scrollTop = chatContentRef.current.scrollHeight;\n    }\n  }, [currentConversation?.messages, globalMessages, isLoading]);\n\n  // í›ˆìŠµ ë°ì´í„° ë¡œë”©ì„ ë” ì •í™•í•˜ê²Œ ìˆ˜ì •\n  useEffect(() => {\n    const loadTrainingData = async () => {\n      if (!currentInterpretation?.personaId) return;\n\n      try {\n        // ìŠ¤ë ˆë“œ ë°ì´í„° ë¡œë“œ\n        const threadsResponse = await chatApi.getPersonaThreads(currentInterpretation.personaId);\n        if (threadsResponse.data) {\n          setThreads(threadsResponse.data);\n          \n          // ë‚˜ì•„ê°€ê¸°ì™€ ë¬¸ì¥ ìŠ¤ë ˆë“œì—ì„œ ì½˜í…ì¸  ì¶”ì¶œ\n          const proceedThread = threadsResponse.data.find(t => t.thread_type === 'proceed');\n          const sentenceThread = threadsResponse.data.find(t => t.thread_type === 'sentence');\n          \n          if (proceedThread && proceedThread.messages.length > 0) {\n            const firstProceedMessage = proceedThread.messages.find(m => m.role === 'assistant');\n            if (firstProceedMessage) {\n              setProceedContent(firstProceedMessage.content);\n            }\n          }\n          \n          if (sentenceThread && sentenceThread.messages.length > 0) {\n            const firstSentenceMessage = sentenceThread.messages.find(m => m.role === 'assistant');\n            if (firstSentenceMessage) {\n              setSentenceContent(firstSentenceMessage.content);\n            }\n          }\n        }\n      } catch (error) {\n        console.error('í›ˆìŠµ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);\n      }\n    };\n\n    loadTrainingData();\n  }, [currentInterpretation?.personaId]);\n\n  // ìŠ¤ë ˆë“œ ì—…ë°ì´íŠ¸ ì‹œ ì½˜í…ì¸ ë„ ì—…ë°ì´íŠ¸\n  useEffect(() => {\n    const proceedThread = threads.find(t => t.thread_type === 'proceed');\n    const sentenceThread = threads.find(t => t.thread_type === 'sentence');\n    \n    if (proceedThread && proceedThread.messages.length > 0) {\n      const firstProceedMessage = proceedThread.messages.find(m => m.role === 'assistant');\n      if (firstProceedMessage) {\n        setProceedContent(firstProceedMessage.content);\n      }\n    }\n    \n    if (sentenceThread && sentenceThread.messages.length > 0) {\n      const firstSentenceMessage = sentenceThread.messages.find(m => m.role === 'assistant');\n      if (firstSentenceMessage) {\n        setSentenceContent(firstSentenceMessage.content);\n      }\n    }\n  }, [threads]);\n\n  // ìƒí˜¸ì‘ìš© ê¸°ë¡ ë¡œë“œ\n  useEffect(() => {\n    const loadInteractionRecords = async () => {\n      try {\n        const recordsResponse = await chatApi.getAllInteractionRecords();\n        if (recordsResponse.data) {\n          setInteractionRecords(recordsResponse.data);\n        }\n      } catch (error) {\n        console.error('ìƒí˜¸ì‘ìš© ê¸°ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);\n      }\n    };\n\n    loadInteractionRecords();\n  }, [currentInterpretation, threads]); // threadsë‚˜ currentInterpretationì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ ìƒˆë¡œê³ ì¹¨\n\n  const handleSendMessage = async (message: string) => {\n    if (selectedConversation) {\n      // ê¸°ì¡´ ëŒ€í™”ì— ë©”ì‹œì§€ ì¶”ê°€\n      return await onContinueConversation(selectedConversation, message);\n    } else if (currentInterpretation) {\n      // í•´ì„ ëª¨ë“œì—ì„œëŠ” í•´ì„ ê´€ë ¨ ë©”ì‹œì§€ ì „ì†¡\n      return await onInterpretationMessage(message);\n    } else {\n      // ìƒˆë¡œìš´ ëŒ€í™” ì‹œì‘\n      return await onSendInitialMessage(message);\n    }\n  };\n\n  // í•´ì„ ë©”ì‹œì§€ ìˆ˜ì • í•¸ë“¤ëŸ¬\n  const handleEditInterpretationMessage = async (messageIndex: number, newContent: string): Promise<boolean> => {\n    if (!currentInterpretation) return false;\n\n    try {\n      // ë©”ì‹œì§€ ìˆ˜ì • - ìˆ˜ì • í›„ ìƒˆë¡œìš´ ì‘ë‹µ ìë™ ìƒì„±\n      const updatedMessages = [...currentInterpretation.messages];\n      if (messageIndex >= 0 && messageIndex < updatedMessages.length) {\n        // ìˆ˜ì •ëœ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸\n        updatedMessages[messageIndex] = {\n          ...updatedMessages[messageIndex],\n          content: newContent,\n          timestamp: new Date().toISOString(),\n        };\n\n        // ìˆ˜ì •ëœ ë©”ì‹œì§€ ì´í›„ì˜ ëª¨ë“  ë©”ì‹œì§€ë“¤ ì œê±°\n        const filteredMessages = updatedMessages.slice(0, messageIndex + 1);\n\n        // ë°±ì—”ë“œ APIë¥¼ í†µí•´ ìƒˆë¡œìš´ AI ì‘ë‹µ ìƒì„±\n        try {\n          const response = await chatApi.chatWithInterpretation(\n            currentInterpretation.personaId,\n            newContent\n          );\n\n          if (response.data) {\n            const aiResponse = {\n              role: 'assistant' as const,\n              content: response.data.response,\n              timestamp: response.data.timestamp,\n            };\n\n            const updatedInterpretation = {\n              ...currentInterpretation,\n              messages: [...filteredMessages, aiResponse],\n            };\n\n            // ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì— ì—…ë°ì´íŠ¸ ì•Œë¦¼\n            if (onUpdateInterpretation) {\n              onUpdateInterpretation(updatedInterpretation);\n            }\n\n            return true;\n          } else {\n            // API í˜¸ì¶œ ì‹¤íŒ¨ ì‹œ ë¡œì»¬ì—ì„œ ì„ì‹œ ì‘ë‹µ ìƒì„±\n            const aiResponse = {\n              role: 'assistant' as const,\n              content: `${currentInterpretation.personaName}ì˜ ê´€ì ì—ì„œ ìˆ˜ì •ëœ ë©”ì‹œì§€ì— ëŒ€í•´ ìƒˆë¡­ê²Œ ì‘ë‹µë“œë¦¬ê² ìŠµë‹ˆë‹¤.\\n\\n\"${newContent}\"ì— ëŒ€í•´ ë¶„ì„í•´ë³´ë©´, ì´ëŠ” ì´ì „ê³¼ëŠ” ë‹¤ë¥¸ ë§¥ë½ì„ ì œì‹œí•˜ê³  ìˆìŠµë‹ˆë‹¤. ìˆ˜ì •ëœ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ìƒˆë¡œìš´ í•´ì„ê³¼ í†µì°°ì„ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤.`,\n              timestamp: new Date().toISOString(),\n            };\n\n            const updatedInterpretation = {\n              ...currentInterpretation,\n              messages: [...filteredMessages, aiResponse],\n            };\n\n            if (onUpdateInterpretation) {\n              onUpdateInterpretation(updatedInterpretation);\n            }\n\n            return true;\n          }\n        } catch (apiError) {\n          console.error('í•´ì„ API í˜¸ì¶œ ì‹¤íŒ¨:', apiError);\n          \n          // API í˜¸ì¶œ ì‹¤íŒ¨ ì‹œ ë¡œì»¬ì—ì„œ ì„ì‹œ ì‘ë‹µ ìƒì„±\n          const aiResponse = {\n            role: 'assistant' as const,\n            content: `${currentInterpretation.personaName}ì˜ ê´€ì ì—ì„œ ìˆ˜ì •ëœ ë©”ì‹œì§€ì— ëŒ€í•´ ìƒˆë¡­ê²Œ ì‘ë‹µë“œë¦¬ê² ìŠµë‹ˆë‹¤.\\n\\n\"${newContent}\"ì— ëŒ€í•´ ë¶„ì„í•´ë³´ë©´, ì´ëŠ” ì´ì „ê³¼ëŠ” ë‹¤ë¥¸ ë§¥ë½ì„ ì œì‹œí•˜ê³  ìˆìŠµë‹ˆë‹¤. ìˆ˜ì •ëœ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ìƒˆë¡œìš´ í•´ì„ê³¼ í†µì°°ì„ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤.`,\n            timestamp: new Date().toISOString(),\n          };\n\n          const updatedInterpretation = {\n            ...currentInterpretation,\n            messages: [...filteredMessages, aiResponse],\n          };\n\n          if (onUpdateInterpretation) {\n            onUpdateInterpretation(updatedInterpretation);\n          }\n\n          return true;\n        }\n      }\n      return false;\n    } catch (error) {\n      console.error('í•´ì„ ë©”ì‹œì§€ ìˆ˜ì • ì‹¤íŒ¨:', error);\n      return false;\n    }\n  };\n\n  // ì¼ë°˜ ëŒ€í™” ë©”ì‹œì§€ ìˆ˜ì • í•¸ë“¤ëŸ¬\n  const handleEditConversationMessage = async (messageIndex: number, newContent: string): Promise<boolean> => {\n    if (!selectedConversation || !currentConversation) return false;\n\n    try {\n      const result = await chatApi.editMessage(selectedConversation, messageIndex, newContent);\n      \n      if (result.data?.success && result.data.updated_conversation) {\n        // ìˆ˜ì •ëœ ëŒ€í™” ì •ë³´ë¡œ ì¦‰ì‹œ UI ì—…ë°ì´íŠ¸\n        if (onUpdateConversation) {\n          onUpdateConversation(result.data.updated_conversation);\n        }\n        \n        return true;\n      } else {\n        console.error('ë©”ì‹œì§€ ìˆ˜ì • ì‹¤íŒ¨:', result.error);\n        return false;\n      }\n    } catch (error) {\n      console.error('ë©”ì‹œì§€ ìˆ˜ì • ìš”ì²­ ì‹¤íŒ¨:', error);\n      return false;\n    }\n  };\n\n  const getHeaderTitle = () => {\n    if (selectedConversation && currentConversation) {\n      const persona = personas[currentConversation.persona_id];\n      return `${persona?.name}ê³¼ì˜ ëŒ€í™”`;\n    }\n    return 'ë‹¤ì¤‘ í˜ë¥´ì†Œë‚˜ ì±„íŒ…';\n  };\n\n  const getHeaderSubtitle = () => {\n    if (selectedConversation && currentConversation) {\n      return `${currentConversation.messages.length}ê°œì˜ ë©”ì‹œì§€`;\n    }\n    return 'ëª¨ë“  í˜ë¥´ì†Œë‚˜ì™€ ëŒ€í™”í•˜ê±°ë‚˜ ê°œë³„ í˜ë¥´ì†Œë‚˜ë¥¼ ì„ íƒí•˜ì„¸ìš”';\n  };\n\n  const renderInitialResponses = () => {\n    if (!globalMessages.length) return null;\n    \n    const latestMessage = globalMessages[globalMessages.length - 1];\n    \n    return (\n      <div>\n        {/* ì‚¬ìš©ì ì§ˆë¬¸ */}\n        <Message\n          message={{\n            role: 'user',\n            content: latestMessage.user_message,\n            timestamp: latestMessage.timestamp,\n          }}\n          personas={personas}\n          showActionButtons={false}\n        />\n        \n        {/* ëª¨ë“  í˜ë¥´ì†Œë‚˜ ì‘ë‹µ */}\n        {latestMessage.responses.map((response) => (\n          <Message\n            key={`${latestMessage.id}_${response.persona_id}`}\n            message={{\n              role: 'assistant',\n              content: response.content,\n              timestamp: response.timestamp,\n              persona_id: response.persona_id,\n              persona_name: response.persona_name,\n            }}\n            personas={personas}\n            showActionButtons={true}\n          />\n        ))}\n        \n        <div style={{\n          margin: '20px 0',\n          padding: '16px',\n          backgroundColor: '#f8f8f8',\n          borderRadius: '8px',\n          border: 'none',\n          textAlign: 'center',\n        }}>\n          <div style={{ fontSize: '14px', color: '#666', marginBottom: '8px' }}>\n            ğŸ’¡ ê° í˜ë¥´ì†Œë‚˜ì™€ ê°œë³„ì ìœ¼ë¡œ ëŒ€í™”ë¥¼ ì´ì–´ê°€ë ¤ë©´\n          </div>\n          <div style={{ fontSize: '13px', color: '#888' }}>\n            ì™¼ìª½ ì‚¬ì´ë“œë°”ì—ì„œ í˜ë¥´ì†Œë‚˜ë¥¼ ì„ íƒí•˜ê±°ë‚˜, íŠ¹ì • ëŒ€í™”ë¥¼ ì„ íƒí•˜ì„¸ìš”\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  const renderConversation = () => {\n    if (!currentConversation) return null;\n\n    return currentConversation.messages.map((message, index) => (\n      <Message\n        key={`${currentConversation.id}_${index}`}\n        message={message}\n        personas={personas}\n        showActionButtons={true}\n        onCopy={() => {\n          navigator.clipboard.writeText(message.content);\n        }}\n        onEdit={message.role === 'user' ? () => setEditingMessageIndex(index) : undefined}\n        onEditSave={message.role === 'user' ? async (newContent) => {\n          const success = await handleEditConversationMessage(index, newContent);\n                  if (success) {\n          setEditingMessageIndex(null);\n        }\n          return success;\n        } : undefined}\n        onEditCancel={() => setEditingMessageIndex(null)}\n        isEditing={editingMessageIndex === index}\n        onSunAction={() => {}}\n        onPersonAction={() => {}}\n        onDocumentAction={() => {}}\n      />\n    ));\n  };\n\n  const renderEmptyState = () => (\n    <EmptyState>\n      <EmptyStateTitle>ìƒˆë¡œìš´ ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”!</EmptyStateTitle>\n      <EmptyStateText>\n        {Object.keys(personas).length > 0 ? (\n          <>\n            ì•„ë˜ì— ì§ˆë¬¸ì„ ì…ë ¥í•˜ë©´ {Object.keys(personas).length}ê°œì˜ í˜ë¥´ì†Œë‚˜ê°€<br />\n            ê°ê° ë‹¤ë¥¸ ê´€ì ì—ì„œ ë‹µë³€í•´ë“œë¦½ë‹ˆë‹¤.\n          </>\n        ) : (\n          'í˜ë¥´ì†Œë‚˜ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...'\n        )}\n      </EmptyStateText>\n    </EmptyState>\n  );\n\n  // ëª¨ë“œ ì „í™˜ í•¸ë“¤ëŸ¬\n  const handleSwitchToMode = (mode: 'interpretation' | 'proceed' | 'sentence') => {\n    if (onSwitchConversationMode) {\n      onSwitchConversationMode(mode);\n    }\n  };\n\n  // ìƒˆë¡œìš´ í•´ì„ ìƒì„± í•¸ë“¤ëŸ¬\n  const handleGenerateNewInterpretation = async () => {\n    if (!currentInterpretation?.personaId) return;\n    \n    try {\n      // ìƒˆë¡œìš´ í•´ì„ì„ ìƒì„±í•˜ê³  ì™„ë£Œ ì½œë°± í˜¸ì¶œ\n      onInterpretationComplete(currentInterpretation.personaId, 'ìƒˆë¡œìš´ í•´ì„ì„ ìƒì„±í•©ë‹ˆë‹¤...');\n    } catch (error) {\n      console.error('ìƒˆë¡œìš´ í•´ì„ ìƒì„± ì‹¤íŒ¨:', error);\n    }\n  };\n\n  // ì„ íƒëœ ìŠ¤ë ˆë“œ ì¶”ì¶œ\n  const getSelectedThread = (conversationItem: string | null | undefined): TrainingThread | null => {\n    if (!conversationItem || !conversationItem.includes('-thread-')) return null;\n    \n    const threadId = conversationItem.split('-thread-')[1];\n    return threads.find(thread => thread.id === threadId) || null;\n  };\n\n  // ìŠ¤ë ˆë“œ ìƒˆë¡œê³ ì¹¨ í•¨ìˆ˜\n  const handleRefreshThreads = async () => {\n    if (!currentInterpretation?.personaId) return;\n    \n    try {\n      const threadsResponse = await chatApi.getPersonaThreads(currentInterpretation.personaId);\n      if (threadsResponse.data) {\n        const updatedThreads = threadsResponse.data;\n        setThreads(updatedThreads);\n        \n        // ì½˜í…ì¸  ì—…ë°ì´íŠ¸\n        const proceedThread = updatedThreads.find(t => t.thread_type === 'proceed');\n        const sentenceThread = updatedThreads.find(t => t.thread_type === 'sentence');\n        \n        if (proceedThread && proceedThread.messages.length > 0) {\n          const firstProceedMessage = proceedThread.messages.find(m => m.role === 'assistant');\n          if (firstProceedMessage) {\n            setProceedContent(firstProceedMessage.content);\n          }\n        }\n        \n        if (sentenceThread && sentenceThread.messages.length > 0) {\n          const firstSentenceMessage = sentenceThread.messages.find(m => m.role === 'assistant');\n          if (firstSentenceMessage) {\n            setSentenceContent(firstSentenceMessage.content);\n          }\n        }\n        \n        // ConversationSidebar ìƒˆë¡œê³ ì¹¨\n        if (onRefreshConversationSidebar) {\n          onRefreshConversationSidebar();\n        }\n      }\n    } catch (error) {\n      console.error('ìŠ¤ë ˆë“œ ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨:', error);\n    }\n  };\n\n  // í•´ì„ ë·° ë Œë”ë§\n  const renderInterpretationView = () => {\n    if (!currentInterpretation) return null;\n\n    return (\n      <InterpretationView\n        interpretation={currentInterpretation.content}\n        personaName={currentInterpretation.personaName}\n        onSendMessage={onInterpretationMessage}\n        onEditMessage={handleEditInterpretationMessage}\n        isLoading={isLoading}\n        messages={currentInterpretation.messages}\n        onGenerateNewInterpretation={handleGenerateNewInterpretation}\n        onSwitchToMode={handleSwitchToMode}\n        personaId={currentInterpretation.personaId}\n        onRefreshThreads={handleRefreshThreads}\n      />\n    );\n  };\n\n  // ë‚˜ì•„ê°€ê¸° ë·° ë Œë”ë§\n  const renderProceedView = () => {\n    if (!currentInterpretation) return null;\n\n    const selectedThread = getSelectedThread(selectedConversationItem);\n\n    return (\n      <ProceedView\n        personaId={currentInterpretation.personaId}\n        personaName={currentInterpretation.personaName}\n        proceedContent={proceedContent || 'ë‚˜ì•„ê°€ê¸°ë¥¼ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...'}\n        threads={threads}\n        onThreadUpdate={(updatedThreads) => {\n          setThreads(updatedThreads);\n          // ìŠ¤ë ˆë“œ ì—…ë°ì´íŠ¸ ì‹œ ì½˜í…ì¸ ë„ ì—…ë°ì´íŠ¸\n          const proceedThread = updatedThreads.find(t => t.thread_type === 'proceed');\n          if (proceedThread && proceedThread.messages.length > 0) {\n            const firstProceedMessage = proceedThread.messages.find(m => m.role === 'assistant');\n            if (firstProceedMessage) {\n              setProceedContent(firstProceedMessage.content);\n            }\n          }\n          // ConversationSidebar ìƒˆë¡œê³ ì¹¨\n          if (onRefreshConversationSidebar) {\n            onRefreshConversationSidebar();\n          }\n        }}\n        onSwitchToMode={handleSwitchToMode}\n        onGenerateNewInterpretation={handleGenerateNewInterpretation}\n        selectedThread={selectedThread}\n      />\n    );\n  };\n\n  // ë¬¸ì¥ ë·° ë Œë”ë§\n  const renderSentenceView = () => {\n    if (!currentInterpretation) return null;\n\n    const selectedThread = getSelectedThread(selectedConversationItem);\n\n    return (\n      <SentenceView\n        personaId={currentInterpretation.personaId}\n        personaName={currentInterpretation.personaName}\n        sentenceContent={sentenceContent || 'ë¬¸ì¥ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...'}\n        threads={threads}\n        onThreadUpdate={(updatedThreads) => {\n          setThreads(updatedThreads);\n          // ìŠ¤ë ˆë“œ ì—…ë°ì´íŠ¸ ì‹œ ì½˜í…ì¸ ë„ ì—…ë°ì´íŠ¸\n          const sentenceThread = updatedThreads.find(t => t.thread_type === 'sentence');\n          if (sentenceThread && sentenceThread.messages.length > 0) {\n            const firstSentenceMessage = sentenceThread.messages.find(m => m.role === 'assistant');\n            if (firstSentenceMessage) {\n              setSentenceContent(firstSentenceMessage.content);\n            }\n          }\n          // ConversationSidebar ìƒˆë¡œê³ ì¹¨\n          if (onRefreshConversationSidebar) {\n            onRefreshConversationSidebar();\n          }\n        }}\n        onSwitchToMode={handleSwitchToMode}\n        onGenerateNewInterpretation={handleGenerateNewInterpretation}\n        selectedThread={selectedThread}\n      />\n    );\n  };\n\n  // ìƒí˜¸ì‘ìš© ê¸°ë¡ ë·° ë Œë”ë§\n  const renderInteractionHistoryView = () => {\n    if (!currentInterpretation) return null;\n\n    return (\n      <InteractionHistoryView\n        personaId={currentInterpretation.personaId}\n        personaName={currentInterpretation.personaName}\n        allInteractionRecords={interactionRecords}\n        onThreadSelect={handleInteractionThreadSelect}\n        onSwitchToMode={handleSwitchToMode}\n        onGenerateNewInterpretation={handleGenerateNewInterpretation}\n      />\n    );\n  };\n\n  // ìƒí˜¸ì‘ìš© ê¸°ë¡ì—ì„œ ìŠ¤ë ˆë“œ ì„ íƒ í•¸ë“¤ëŸ¬\n  const handleInteractionThreadSelect = (thread: TrainingThread) => {\n    // í•´ë‹¹ ìŠ¤ë ˆë“œì˜ ëª¨ë“œë¡œ ì „í™˜í•˜ê³  ìŠ¤ë ˆë“œ ì„ íƒ\n    if (onSwitchConversationMode) {\n      onSwitchConversationMode(`${thread.thread_type}-thread-${thread.id}`);\n    }\n  };\n\n  return (\n    <MainArea>\n      {/* ë©”ì¸ ì˜ì—­ í—¤ë” - ì‚¬ì´ë“œë°”ì™€ ë†’ì´ ë§ì¶¤ (80px) - ë¹ˆ ê³µê°„ */}\n          <div style={{ \n        height: '80px',\n        borderBottom: '1px solid #ddd',\n        background: 'white',\n          }}>\n        {/* ë¹ˆ í—¤ë” ê³µê°„ */}\n          </div>\n\n      {/* í›ˆìŠµ ëª¨ë“œì¼ ë•Œ ì¹´í…Œê³ ë¦¬ ë·° í‘œì‹œ */}\n      {selectedPersonaItem === 'training' ? (\n        <TrainingCategoryView\n          personas={personas}\n          onSelectPersona={onSelectPersona || (() => {})}\n          onInterpretationComplete={onInterpretationComplete}\n        />\n      ) : selectedPersonaItem === 'recent' ? (\n        // ìµœê·¼ ìƒí˜¸ì‘ìš© ëª¨ë“œì¼ ë•Œ RecentInteractionsView í‘œì‹œ\n        <RecentInteractionsView\n          personas={recentInteractionsProps?.personas || {}}\n          onSelectPersona={recentInteractionsProps?.onSelectPersona || (() => {})}\n          onThreadSelect={recentInteractionsProps?.onThreadSelect || (() => {})}\n          selectedThreadId={\n            selectedConversationItem?.startsWith('recent-thread-') \n              ? selectedConversationItem.split('-')[2]\n              : undefined\n          }\n          selectedPersonaId={\n            selectedConversationItem?.startsWith('recent-thread-') \n              ? selectedConversationItem.split('-')[3]\n              : undefined\n          }\n        />\n      ) : selectedPersonaItem === 'admin' ? (\n        <PersonaAdminPanel \n          onClose={() => {\n            // ê´€ë¦¬ ëª¨ë“œ ì¢…ë£Œ ì‹œ PersonaSidebarë¡œ ëŒì•„ê°€ê¸°\n            if (onSelectPersona) {\n              onSelectPersona(''); // ë¹ˆ ê°’ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ PersonaSidebarì˜ selectedItemì„ nullë¡œ ë§Œë“¦\n            }\n          }}\n        />\n      ) : currentInterpretation && (selectedConversationItem === 'proceed' || selectedConversationItem?.startsWith('proceed-thread-')) ? (\n        // ë‚˜ì•„ê°€ê¸° ëª¨ë“œì¼ ë•Œ ProceedView ì‚¬ìš©\n        renderProceedView()\n      ) : currentInterpretation && (selectedConversationItem === 'sentence' || selectedConversationItem?.startsWith('sentence-thread-')) ? (\n        // ë¬¸ì¥ ëª¨ë“œì¼ ë•Œ SentenceView ì‚¬ìš©\n        renderSentenceView()\n      ) : currentInterpretation && (selectedConversationItem === 'interpretation' || selectedConversationItem?.startsWith('interpretation-thread-')) ? (\n        // í•´ì„ ëª¨ë“œì¼ ë•Œ InterpretationView ì‚¬ìš©\n        renderInterpretationView()\n      ) : currentInterpretation && selectedConversationItem === 'interaction_history' ? (\n        // ìƒí˜¸ì‘ìš© ê¸°ë¡ ëª¨ë“œì¼ ë•Œ InteractionHistoryView ì‚¬ìš©\n        renderInteractionHistoryView()\n      ) : (\n        <>\n      <ChatContent ref={chatContentRef}>\n        {/* {error && (\n          <ErrorMessage onClick={onClearError}>\n            {error} (í´ë¦­í•˜ì—¬ ë‹«ê¸°)\n          </ErrorMessage>\n        )} */}\n\n            {!selectedConversation && !currentInterpretation && globalMessages.length === 0 && renderEmptyState()}\n            {!selectedConversation && !currentInterpretation && globalMessages.length > 0 && renderInitialResponses()}\n        {selectedConversation && renderConversation()}\n\n        {isLoading && (\n          selectedConversation && currentConversation ? (\n            <LoadingMessage \n              personaName={personas[currentConversation.persona_id]?.name}\n              personaColor={personas[currentConversation.persona_id]?.color}\n            />\n          ) : (\n            <LoadingMessage \n              personaName=\"AI\"\n              personaColor=\"#666\"\n            />\n          )\n        )}\n      </ChatContent>\n\n      <MessageInput\n        onSendMessage={handleSendMessage}\n        disabled={isLoading || Object.keys(personas).length === 0}\n        placeholder={\n          selectedConversation && currentConversation\n            ? `${personas[currentConversation.persona_id]?.name}ì—ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ì„¸ìš”...`\n            : \"ëª¨ë“  í˜ë¥´ì†Œë‚˜ì—ê²Œ ì§ˆë¬¸í•´ë³´ì„¸ìš”...\"\n        }\n      />\n        </>\n      )}\n    </MainArea>\n  );\n};\n\nexport default ChatArea; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}