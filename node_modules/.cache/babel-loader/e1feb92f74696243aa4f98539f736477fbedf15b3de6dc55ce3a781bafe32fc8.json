{"ast":null,"code":"import _taggedTemplateLiteral from\"C:/Users/sungh/Desktop/chat_work/frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject0,_templateObject1,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14,_templateObject15,_templateObject16;import React,{useState,useEffect,useRef}from'react';import styled from'styled-components';import{chatApi}from'../api/chatApi';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  height: \",\"px;\\n  background: white;\\n  border-bottom: 1px solid #e0e0e0;\\n  position: relative;\\n\"])),props=>props.height);const Header=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  padding: 20px;\\n  border-bottom: 1px solid #e0e0e0;\\n  background: linear-gradient(135deg, #f8f9fa 0%, #f1f3f4 100%);\\n  cursor: pointer;\\n  \\n  &:hover {\\n    background: linear-gradient(135deg, #f1f3f4 0%, #e9ecef 100%);\\n  }\\n\"])));const Title=styled.h2(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  font-size: 20px;\\n  font-weight: 600;\\n  color: #333;\\n  margin: 0 0 8px 0;\\n\"])));const Subtitle=styled.p(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  font-size: 14px;\\n  color: #666;\\n  margin: 0;\\n\"])));const InteractionsList=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  overflow-y: auto;\\n  padding: \",\";\\n  display: \",\";\\n  flex-direction: column;\\n  gap: 16px;\\n\"])),props=>props.isExpanded?'20px':'0',props=>props.isExpanded?'flex':'none');const InteractionCard=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  border: 1px solid #e0e0e0;\\n  border-radius: 12px;\\n  background: white;\\n  overflow: hidden;\\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\\n  transition: all 0.2s ease;\\n  \\n  &:hover {\\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);\\n    transform: translateY(-2px);\\n  }\\n\"])));const ThreadsContainer=styled.div(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  padding: 16px 20px;\\n\"])));const ThreadItem=styled.div(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  padding: 12px 16px;\\n  margin-bottom: 8px;\\n  border: 1px solid #f0f0f0;\\n  border-radius: 8px;\\n  cursor: pointer;\\n  transition: all 0.2s ease;\\n  \\n  &:hover {\\n    background: #f8f9fa;\\n    border-color: #6c757d;\\n  }\\n  \\n  &:last-child {\\n    margin-bottom: 0;\\n  }\\n\"])));const ThreadHeader=styled.div(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  margin-bottom: 8px;\\n\"])));const ThreadType=styled.span(_templateObject0||(_templateObject0=_taggedTemplateLiteral([\"\\n  display: inline-block;\\n  padding: 4px 8px;\\n  border-radius: 6px;\\n  font-size: 10px;\\n  font-weight: 600;\\n  text-transform: uppercase;\\n  background-color: #6c757d;\\n  color: white;\\n\"])));const ThreadTime=styled.span(_templateObject1||(_templateObject1=_taggedTemplateLiteral([\"\\n  font-size: 12px;\\n  color: #666;\\n\"])));const ThreadContent=styled.div(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  font-size: 14px;\\n  color: #333;\\n  line-height: 1.4;\\n\"])));const EmptyState=styled.div(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  align-items: center;\\n  color: #999;\\n  font-size: 14px;\\n  text-align: center;\\n  padding: 40px 20px;\\n\"])));const Resizer=styled.div(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n  height: 6px;\\n  background: #f0f0f0;\\n  cursor: row-resize;\\n  border-top: 1px solid #e0e0e0;\\n  transition: background-color 0.2s ease;\\n  \\n  &:hover {\\n    background: #ddd;\\n  }\\n  \\n  &:active {\\n    background: #ccc;\\n  }\\n\"])));const PersonaSection=styled.div(_templateObject13||(_templateObject13=_taggedTemplateLiteral([\"\\n  border-bottom: 1px solid #f0f0f0;\\n  \\n  &:last-child {\\n    border-bottom: none;\\n  }\\n\"])));const PersonaHeader=styled.div(_templateObject14||(_templateObject14=_taggedTemplateLiteral([\"\\n  padding: 16px 20px;\\n  background: #f8f9fa;\\n  cursor: pointer;\\n  border-bottom: 1px solid #e0e0e0;\\n  transition: background-color 0.2s ease;\\n  \\n  &:hover {\\n    background: #f1f3f4;\\n  }\\n\"])));const PersonaName=styled.h3(_templateObject15||(_templateObject15=_taggedTemplateLiteral([\"\\n  font-size: 16px;\\n  font-weight: 600;\\n  color: #333;\\n  margin: 0 0 4px 0;\\n\"])));const PersonaInfo=styled.div(_templateObject16||(_templateObject16=_taggedTemplateLiteral([\"\\n  font-size: 12px;\\n  color: #666;\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n\"])));const RecentInteractionsView=_ref=>{let{personas,onSelectPersona,onThreadSelect,onClearChat}=_ref;const[interactionRecords,setInteractionRecords]=useState([]);const[loading,setLoading]=useState(true);const[isExpanded,setIsExpanded]=useState(false);const[height,setHeight]=useState(200);const[expandedPersonas,setExpandedPersonas]=useState(new Set());const[isResizing,setIsResizing]=useState(false);const containerRef=useRef(null);useEffect(()=>{const loadInteractionRecords=async()=>{try{setLoading(true);const recordsResponse=await chatApi.getAllInteractionRecords();if(recordsResponse.data){setInteractionRecords(recordsResponse.data);}}catch(error){console.error('상호작용 기록 로드 실패:',error);}finally{setLoading(false);}};loadInteractionRecords();},[]);const handleHeaderClick=()=>{setIsExpanded(!isExpanded);if(!isExpanded){onClearChat();}};const handlePersonaToggle=(personaId,e)=>{e.stopPropagation();const newExpanded=new Set(expandedPersonas);if(newExpanded.has(personaId)){newExpanded.delete(personaId);}else{newExpanded.add(personaId);}setExpandedPersonas(newExpanded);};const handleThreadClick=(thread,personaId,e)=>{e.stopPropagation();onThreadSelect(thread,personaId);};const handleMouseDown=e=>{setIsResizing(true);e.preventDefault();};useEffect(()=>{const handleMouseMove=e=>{if(!isResizing||!containerRef.current)return;const containerRect=containerRef.current.getBoundingClientRect();const newHeight=e.clientY-containerRect.top;const minHeight=100;const maxHeight=window.innerHeight*0.6;setHeight(Math.min(Math.max(newHeight,minHeight),maxHeight));};const handleMouseUp=()=>{setIsResizing(false);};if(isResizing){document.addEventListener('mousemove',handleMouseMove);document.addEventListener('mouseup',handleMouseUp);}return()=>{document.removeEventListener('mousemove',handleMouseMove);document.removeEventListener('mouseup',handleMouseUp);};},[isResizing]);const formatTime=timestamp=>{return new Date(timestamp).toLocaleDateString('ko-KR',{month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'});};const getThreadTypeLabel=type=>{switch(type){case'interpretation':return'해석';case'proceed':return'나아가기';case'sentence':return'문장';default:return type;}};const getThreadContent=thread=>{var _thread$content;if(thread.messages&&thread.messages.length>0){const firstMessage=thread.messages[0];return firstMessage.content.length>100?firstMessage.content.substring(0,100)+'...':firstMessage.content;}return((_thread$content=thread.content)===null||_thread$content===void 0?void 0:_thread$content.length)>100?thread.content.substring(0,100)+'...':thread.content||'내용 없음';};// 페르소나별로 그룹화 (최신 스레드 기준으로 정렬)\nconst groupedByPersona=interactionRecords.sort((a,b)=>new Date(b.updated_at).getTime()-new Date(a.updated_at).getTime());if(loading){return/*#__PURE__*/_jsxs(Container,{height:height,ref:containerRef,children:[/*#__PURE__*/_jsxs(Header,{onClick:handleHeaderClick,children:[/*#__PURE__*/_jsx(Title,{children:\"\\uC0C1\\uD638\\uC791\\uC6A9 \\uAE30\\uB85D\"}),/*#__PURE__*/_jsx(Subtitle,{children:\"\\uB85C\\uB529 \\uC911...\"})]}),/*#__PURE__*/_jsx(InteractionsList,{isExpanded:isExpanded,children:/*#__PURE__*/_jsxs(EmptyState,{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'24px',marginBottom:'8px'},children:\"\\u23F3\"}),/*#__PURE__*/_jsx(\"div\",{children:\"\\uC0C1\\uD638\\uC791\\uC6A9 \\uAE30\\uB85D\\uC744 \\uBD88\\uB7EC\\uC624\\uB294 \\uC911\\uC785\\uB2C8\\uB2E4...\"})]})}),isExpanded&&/*#__PURE__*/_jsx(Resizer,{onMouseDown:handleMouseDown})]});}return/*#__PURE__*/_jsxs(Container,{height:height,ref:containerRef,children:[/*#__PURE__*/_jsxs(Header,{onClick:handleHeaderClick,children:[/*#__PURE__*/_jsx(Title,{children:\"\\uC0C1\\uD638\\uC791\\uC6A9 \\uAE30\\uB85D\"}),/*#__PURE__*/_jsx(Subtitle,{children:isExpanded?'클릭하여 접기':'클릭하여 펼치기'})]}),/*#__PURE__*/_jsx(InteractionsList,{isExpanded:isExpanded,children:groupedByPersona.length===0?/*#__PURE__*/_jsxs(EmptyState,{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'24px',marginBottom:'8px'},children:\"\\uD83D\\uDCCA\"}),/*#__PURE__*/_jsx(\"div\",{children:\"\\uC544\\uC9C1 \\uC0C1\\uD638\\uC791\\uC6A9 \\uAE30\\uB85D\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',marginTop:'4px'},children:\"\\uD398\\uB974\\uC18C\\uB098\\uC640 \\uB300\\uD654\\uD558\\uACE0 \\uD574\\uC11D\\uC744 \\uC0DD\\uC131\\uD558\\uBA74 \\uAE30\\uB85D\\uC774 \\uB9CC\\uB4E4\\uC5B4\\uC9D1\\uB2C8\\uB2E4\"})]}):/*#__PURE__*/_jsx(InteractionCard,{children:groupedByPersona.map(record=>/*#__PURE__*/_jsxs(PersonaSection,{children:[/*#__PURE__*/_jsxs(PersonaHeader,{onClick:e=>handlePersonaToggle(record.persona_id,e),children:[/*#__PURE__*/_jsx(PersonaName,{children:record.persona_name}),/*#__PURE__*/_jsxs(PersonaInfo,{children:[/*#__PURE__*/_jsxs(\"span\",{children:[record.threads.length,\"\\uAC1C \\uC2A4\\uB808\\uB4DC\"]}),/*#__PURE__*/_jsx(\"span\",{children:formatTime(record.updated_at)})]})]}),expandedPersonas.has(record.persona_id)&&/*#__PURE__*/_jsx(ThreadsContainer,{children:record.threads.map(thread=>/*#__PURE__*/_jsxs(ThreadItem,{onClick:e=>handleThreadClick(thread,record.persona_id,e),children:[/*#__PURE__*/_jsxs(ThreadHeader,{children:[/*#__PURE__*/_jsx(ThreadType,{children:getThreadTypeLabel(thread.thread_type)}),/*#__PURE__*/_jsx(ThreadTime,{children:formatTime(thread.created_at)})]}),/*#__PURE__*/_jsx(ThreadContent,{children:getThreadContent(thread)})]},thread.id))})]},record.id))})}),isExpanded&&/*#__PURE__*/_jsx(Resizer,{onMouseDown:handleMouseDown})]});};export default RecentInteractionsView;","map":{"version":3,"names":["React","useState","useEffect","useRef","styled","chatApi","jsx","_jsx","jsxs","_jsxs","Container","div","_templateObject","_taggedTemplateLiteral","props","height","Header","_templateObject2","Title","h2","_templateObject3","Subtitle","p","_templateObject4","InteractionsList","_templateObject5","isExpanded","InteractionCard","_templateObject6","ThreadsContainer","_templateObject7","ThreadItem","_templateObject8","ThreadHeader","_templateObject9","ThreadType","span","_templateObject0","ThreadTime","_templateObject1","ThreadContent","_templateObject10","EmptyState","_templateObject11","Resizer","_templateObject12","PersonaSection","_templateObject13","PersonaHeader","_templateObject14","PersonaName","h3","_templateObject15","PersonaInfo","_templateObject16","RecentInteractionsView","_ref","personas","onSelectPersona","onThreadSelect","onClearChat","interactionRecords","setInteractionRecords","loading","setLoading","setIsExpanded","setHeight","expandedPersonas","setExpandedPersonas","Set","isResizing","setIsResizing","containerRef","loadInteractionRecords","recordsResponse","getAllInteractionRecords","data","error","console","handleHeaderClick","handlePersonaToggle","personaId","e","stopPropagation","newExpanded","has","delete","add","handleThreadClick","thread","handleMouseDown","preventDefault","handleMouseMove","current","containerRect","getBoundingClientRect","newHeight","clientY","top","minHeight","maxHeight","window","innerHeight","Math","min","max","handleMouseUp","document","addEventListener","removeEventListener","formatTime","timestamp","Date","toLocaleDateString","month","day","hour","minute","getThreadTypeLabel","type","getThreadContent","_thread$content","messages","length","firstMessage","content","substring","groupedByPersona","sort","a","b","updated_at","getTime","ref","children","onClick","style","fontSize","marginBottom","onMouseDown","marginTop","map","record","persona_id","persona_name","threads","thread_type","created_at","id"],"sources":["C:/Users/sungh/Desktop/chat_work/frontend/src/features/shared/components/RecentInteractionsView.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport styled from 'styled-components';\r\nimport { chatApi } from '../api/chatApi';\r\nimport { TrainingThread, InteractionRecord, Persona } from '../types';\r\n\r\ninterface RecentInteractionsViewProps {\r\n  personas: Record<string, Persona>;\r\n  onSelectPersona: (personaId: string) => void;\r\n  onThreadSelect: (thread: TrainingThread, personaId: string) => void;\r\n  onClearChat: () => void;\r\n}\r\n\r\nconst Container = styled.div<{ height: number }>`\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: ${props => props.height}px;\r\n  background: white;\r\n  border-bottom: 1px solid #e0e0e0;\r\n  position: relative;\r\n`;\r\n\r\nconst Header = styled.div`\r\n  padding: 20px;\r\n  border-bottom: 1px solid #e0e0e0;\r\n  background: linear-gradient(135deg, #f8f9fa 0%, #f1f3f4 100%);\r\n  cursor: pointer;\r\n  \r\n  &:hover {\r\n    background: linear-gradient(135deg, #f1f3f4 0%, #e9ecef 100%);\r\n  }\r\n`;\r\n\r\nconst Title = styled.h2`\r\n  font-size: 20px;\r\n  font-weight: 600;\r\n  color: #333;\r\n  margin: 0 0 8px 0;\r\n`;\r\n\r\nconst Subtitle = styled.p`\r\n  font-size: 14px;\r\n  color: #666;\r\n  margin: 0;\r\n`;\r\n\r\nconst InteractionsList = styled.div<{ isExpanded: boolean }>`\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  padding: ${props => props.isExpanded ? '20px' : '0'};\r\n  display: ${props => props.isExpanded ? 'flex' : 'none'};\r\n  flex-direction: column;\r\n  gap: 16px;\r\n`;\r\n\r\nconst InteractionCard = styled.div`\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 12px;\r\n  background: white;\r\n  overflow: hidden;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\r\n  transition: all 0.2s ease;\r\n  \r\n  &:hover {\r\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);\r\n    transform: translateY(-2px);\r\n  }\r\n`;\r\n\r\nconst ThreadsContainer = styled.div`\r\n  padding: 16px 20px;\r\n`;\r\n\r\nconst ThreadItem = styled.div`\r\n  padding: 12px 16px;\r\n  margin-bottom: 8px;\r\n  border: 1px solid #f0f0f0;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease;\r\n  \r\n  &:hover {\r\n    background: #f8f9fa;\r\n    border-color: #6c757d;\r\n  }\r\n  \r\n  &:last-child {\r\n    margin-bottom: 0;\r\n  }\r\n`;\r\n\r\nconst ThreadHeader = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 8px;\r\n`;\r\n\r\nconst ThreadType = styled.span`\r\n  display: inline-block;\r\n  padding: 4px 8px;\r\n  border-radius: 6px;\r\n  font-size: 10px;\r\n  font-weight: 600;\r\n  text-transform: uppercase;\r\n  background-color: #6c757d;\r\n  color: white;\r\n`;\r\n\r\nconst ThreadTime = styled.span`\r\n  font-size: 12px;\r\n  color: #666;\r\n`;\r\n\r\nconst ThreadContent = styled.div`\r\n  font-size: 14px;\r\n  color: #333;\r\n  line-height: 1.4;\r\n`;\r\n\r\nconst EmptyState = styled.div`\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  color: #999;\r\n  font-size: 14px;\r\n  text-align: center;\r\n  padding: 40px 20px;\r\n`;\r\n\r\nconst Resizer = styled.div`\r\n  height: 6px;\r\n  background: #f0f0f0;\r\n  cursor: row-resize;\r\n  border-top: 1px solid #e0e0e0;\r\n  transition: background-color 0.2s ease;\r\n  \r\n  &:hover {\r\n    background: #ddd;\r\n  }\r\n  \r\n  &:active {\r\n    background: #ccc;\r\n  }\r\n`;\r\n\r\nconst PersonaSection = styled.div`\r\n  border-bottom: 1px solid #f0f0f0;\r\n  \r\n  &:last-child {\r\n    border-bottom: none;\r\n  }\r\n`;\r\n\r\nconst PersonaHeader = styled.div`\r\n  padding: 16px 20px;\r\n  background: #f8f9fa;\r\n  cursor: pointer;\r\n  border-bottom: 1px solid #e0e0e0;\r\n  transition: background-color 0.2s ease;\r\n  \r\n  &:hover {\r\n    background: #f1f3f4;\r\n  }\r\n`;\r\n\r\nconst PersonaName = styled.h3`\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  color: #333;\r\n  margin: 0 0 4px 0;\r\n`;\r\n\r\nconst PersonaInfo = styled.div`\r\n  font-size: 12px;\r\n  color: #666;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n`;\r\n\r\nconst RecentInteractionsView: React.FC<RecentInteractionsViewProps> = ({\r\n  personas,\r\n  onSelectPersona,\r\n  onThreadSelect,\r\n  onClearChat,\r\n}) => {\r\n  const [interactionRecords, setInteractionRecords] = useState<InteractionRecord[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [isExpanded, setIsExpanded] = useState(false);\r\n  const [height, setHeight] = useState(200);\r\n  const [expandedPersonas, setExpandedPersonas] = useState<Set<string>>(new Set());\r\n  const [isResizing, setIsResizing] = useState(false);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    const loadInteractionRecords = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const recordsResponse = await chatApi.getAllInteractionRecords();\r\n        if (recordsResponse.data) {\r\n          setInteractionRecords(recordsResponse.data);\r\n        }\r\n      } catch (error) {\r\n        console.error('상호작용 기록 로드 실패:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadInteractionRecords();\r\n  }, []);\r\n\r\n  const handleHeaderClick = () => {\r\n    setIsExpanded(!isExpanded);\r\n    if (!isExpanded) {\r\n      onClearChat();\r\n    }\r\n  };\r\n\r\n  const handlePersonaToggle = (personaId: string, e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    const newExpanded = new Set(expandedPersonas);\r\n    if (newExpanded.has(personaId)) {\r\n      newExpanded.delete(personaId);\r\n    } else {\r\n      newExpanded.add(personaId);\r\n    }\r\n    setExpandedPersonas(newExpanded);\r\n  };\r\n\r\n  const handleThreadClick = (thread: TrainingThread, personaId: string, e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    onThreadSelect(thread, personaId);\r\n  };\r\n\r\n  const handleMouseDown = (e: React.MouseEvent) => {\r\n    setIsResizing(true);\r\n    e.preventDefault();\r\n  };\r\n\r\n  useEffect(() => {\r\n    const handleMouseMove = (e: MouseEvent) => {\r\n      if (!isResizing || !containerRef.current) return;\r\n      \r\n      const containerRect = containerRef.current.getBoundingClientRect();\r\n      const newHeight = e.clientY - containerRect.top;\r\n      const minHeight = 100;\r\n      const maxHeight = window.innerHeight * 0.6;\r\n      \r\n      setHeight(Math.min(Math.max(newHeight, minHeight), maxHeight));\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n      setIsResizing(false);\r\n    };\r\n\r\n    if (isResizing) {\r\n      document.addEventListener('mousemove', handleMouseMove);\r\n      document.addEventListener('mouseup', handleMouseUp);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n  }, [isResizing]);\r\n\r\n  const formatTime = (timestamp: string) => {\r\n    return new Date(timestamp).toLocaleDateString('ko-KR', {\r\n      month: 'short',\r\n      day: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit',\r\n    });\r\n  };\r\n\r\n  const getThreadTypeLabel = (type: string) => {\r\n    switch (type) {\r\n      case 'interpretation': return '해석';\r\n      case 'proceed': return '나아가기';\r\n      case 'sentence': return '문장';\r\n      default: return type;\r\n    }\r\n  };\r\n\r\n  const getThreadContent = (thread: TrainingThread) => {\r\n    if (thread.messages && thread.messages.length > 0) {\r\n      const firstMessage = thread.messages[0];\r\n      return firstMessage.content.length > 100 \r\n        ? firstMessage.content.substring(0, 100) + '...' \r\n        : firstMessage.content;\r\n    }\r\n    return thread.content?.length > 100 \r\n      ? thread.content.substring(0, 100) + '...' \r\n      : thread.content || '내용 없음';\r\n  };\r\n\r\n  // 페르소나별로 그룹화 (최신 스레드 기준으로 정렬)\r\n  const groupedByPersona = interactionRecords.sort((a, b) => \r\n    new Date(b.updated_at).getTime() - new Date(a.updated_at).getTime()\r\n  );\r\n\r\n  if (loading) {\r\n    return (\r\n      <Container height={height} ref={containerRef}>\r\n        <Header onClick={handleHeaderClick}>\r\n          <Title>상호작용 기록</Title>\r\n          <Subtitle>로딩 중...</Subtitle>\r\n        </Header>\r\n        <InteractionsList isExpanded={isExpanded}>\r\n          <EmptyState>\r\n            <div style={{ fontSize: '24px', marginBottom: '8px' }}>⏳</div>\r\n            <div>상호작용 기록을 불러오는 중입니다...</div>\r\n          </EmptyState>\r\n        </InteractionsList>\r\n        {isExpanded && <Resizer onMouseDown={handleMouseDown} />}\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container height={height} ref={containerRef}>\r\n      <Header onClick={handleHeaderClick}>\r\n        <Title>상호작용 기록</Title>\r\n        <Subtitle>\r\n          {isExpanded ? '클릭하여 접기' : '클릭하여 펼치기'}\r\n        </Subtitle>\r\n      </Header>\r\n\r\n      <InteractionsList isExpanded={isExpanded}>\r\n        {groupedByPersona.length === 0 ? (\r\n          <EmptyState>\r\n            <div style={{ fontSize: '24px', marginBottom: '8px' }}>📊</div>\r\n            <div>아직 상호작용 기록이 없습니다</div>\r\n            <div style={{ fontSize: '12px', marginTop: '4px' }}>\r\n              페르소나와 대화하고 해석을 생성하면 기록이 만들어집니다\r\n            </div>\r\n          </EmptyState>\r\n        ) : (\r\n          <InteractionCard>\r\n            {groupedByPersona.map((record) => (\r\n              <PersonaSection key={record.id}>\r\n                <PersonaHeader onClick={(e) => handlePersonaToggle(record.persona_id, e)}>\r\n                  <PersonaName>{record.persona_name}</PersonaName>\r\n                  <PersonaInfo>\r\n                    <span>{record.threads.length}개 스레드</span>\r\n                    <span>{formatTime(record.updated_at)}</span>\r\n                  </PersonaInfo>\r\n                </PersonaHeader>\r\n                \r\n                {expandedPersonas.has(record.persona_id) && (\r\n                  <ThreadsContainer>\r\n                    {record.threads.map((thread) => (\r\n                      <ThreadItem\r\n                        key={thread.id}\r\n                        onClick={(e) => handleThreadClick(thread, record.persona_id, e)}\r\n                      >\r\n                        <ThreadHeader>\r\n                          <ThreadType>\r\n                            {getThreadTypeLabel(thread.thread_type)}\r\n                          </ThreadType>\r\n                          <ThreadTime>{formatTime(thread.created_at)}</ThreadTime>\r\n                        </ThreadHeader>\r\n                        <ThreadContent>{getThreadContent(thread)}</ThreadContent>\r\n                      </ThreadItem>\r\n                    ))}\r\n                  </ThreadsContainer>\r\n                )}\r\n              </PersonaSection>\r\n            ))}\r\n          </InteractionCard>\r\n        )}\r\n      </InteractionsList>\r\n      \r\n      {isExpanded && <Resizer onMouseDown={handleMouseDown} />}\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default RecentInteractionsView; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}